#include <linux/module.h>
#include <linux/types.h>
#include <linux/slab.h>
#include <linux/mpi.h>
#include <linux/random.h>
#include <linux/kthread.h>

#include "sp-crypto.h"
#include "sp-rsa.h"

typedef int (*test_func)(void *para);

struct test_case {
	test_func fun;
	const char *name;
};

typedef struct rsa_keypair_t{
	char e1[256];
	char e2[256];
	char n[256];
	u32 len;
	u32 sort;  /*0:big endbian, 1:small endbian*/
}rsa_keypair_t;


rsa_keypair_t rsa_keyparit[] =
{
	// 0
	{
		.e1 = { 0x01, 0x00, 0x01 },
		.e2 = { 0x41, 0x2a, 0xc0, 0x34, 0x13, 0x69, 0x05, 0xbe, 0x69, 0xaa, 0x41, 0xb7, 0x27, 0x77, 0x5c, 0x68, 0x44, 0x90, 0x1b, 0x6b, 0xc6, 0x28, 0xd7, 0x32, 0x0e, 0x95, 0xee, 0x7c, 0x1a, 0xa8, 0x13, 0x8e, 0xb3, 0xb6, 0x47, 0xaf, 0x48, 0xce, 0xd4, 0x03, 0xea, 0xd5, 0xed, 0x21, 0x77, 0xb2, 0x39, 0x2c, 0xc6, 0x3b, 0x85, 0xdd, 0xe7, 0xd3, 0x4e, 0x29, 0xe0, 0x0e, 0xdd, 0x52, 0x49, 0xd9, 0x2a, 0x92, 0xf3, 0xdd, 0x0d, 0x99, 0x14, 0x86, 0xb8, 0x89, 0x68, 0x71, 0x57, 0xc6, 0x47, 0x45, 0x4e, 0xf7, 0xa8, 0xf0, 0x1d, 0xad, 0x4e, 0x01, 0x1a, 0x14, 0xc2, 0x89, 0xe4, 0x08, 0xbc, 0xcd, 0x86, 0x6a, 0x6a, 0xc3, 0x24, 0xc5, 0xd5, 0x6a, 0xef, 0x30, 0xac, 0x7a, 0xc6, 0xd3, 0x4c, 0x51, 0xd1, 0xe9, 0x2a, 0xbf, 0x79, 0xfa, 0x1d, 0x91, 0x81, 0xb4, 0x79, 0x73, 0x39, 0x0f, 0xdd, 0x38, 0xa7, 0xb2, 0x8b, 0x00, 0xe3, 0xc7, 0xdc, 0x47, 0x46, 0x0c, 0x27, 0x7d, 0x99, 0xc1, 0x1d, 0xfd, 0x36, 0x16, 0x06, 0xaa, 0x76, 0x5a, 0x5a, 0x42, 0x5c, 0xdb, 0x75, 0x4d, 0xe0, 0xe0, 0xe0, 0xc0, 0x09, 0x2f, 0x57, 0xe9, 0x4c, 0x9a, 0xc0, 0xcf, 0x24, 0xcb, 0xaf, 0xe4, 0xda, 0x15, 0x3a, 0x74, 0x5f, 0x8e, 0xc2, 0x38, 0xfc, 0x9c, 0x2a, 0xd3, 0x74, 0x20, 0xce, 0x28, 0x4e, 0x53, 0xe3, 0xe6, 0xf1, 0xff, 0x34, 0x56, 0x7c, 0xf4, 0x45, 0xa2, 0x56, 0xdb, 0xcf, 0x18, 0x45, 0xf3, 0x0c, 0x7d, 0xd0, 0xa6, 0x6c, 0xd9, 0xcf, 0x5c, 0xfc, 0xab, 0x87, 0x35, 0x06, 0x40, 0xf4, 0xb8, 0x46, 0x16, 0xee, 0x31, 0x50, 0xf5, 0x24, 0xdc, 0xca, 0xf0, 0xec, 0xd4, 0x04, 0x52, 0x7b, 0x3c, 0xb5, 0x40, 0x2c, 0xb3, 0x07, 0x6f, 0x7a, 0x82, 0x39, 0x1b, 0x8e, 0xaa, 0x36, 0xfd, 0x39, 0x86, 0xde, 0xef, 0xbc, 0x04 },
		.n = { 0x4b, 0x86, 0xf8, 0x84, 0xfc, 0x68, 0xcc, 0xd2, 0x01, 0x14, 0xc7,
			 0xcb, 0x34, 0x48, 0xf0, 0xce, 0x9e, 0xd9, 0xae, 0x02, 0x19, 0xee,
			 0xe9, 0xaf, 0xb5, 0xcf, 0xcf, 0xba, 0xec, 0x39, 0x40, 0x03, 0xd2,
			 0x61, 0x50, 0x1f, 0x25, 0x04, 0x82, 0x44, 0x98, 0x45, 0xef, 0xed,
			 0xf5, 0xcd, 0x9d, 0x61, 0xa1, 0x30, 0x3e, 0xf6, 0x47, 0x37, 0x27,
			 0x2d, 0x56, 0xed, 0x3a, 0xe0, 0x6a, 0x69, 0x8a, 0xe2, 0x00, 0x06,
			 0x8d, 0x81, 0x07, 0x5e, 0xb0, 0xe9, 0xa1, 0x75, 0xf4, 0x62, 0x2f,
			 0xfe, 0x84, 0xce, 0x29, 0x8f, 0x6a, 0xe2, 0x9b, 0x4a, 0x3a, 0x62,
			 0xfc, 0x58, 0xb9, 0x6c, 0x0d, 0xd0, 0x18, 0x5d, 0x00, 0x13, 0xd4,
			 0x8a, 0x80, 0xda, 0xe1, 0xfa, 0x04, 0x3e, 0xd7, 0x49, 0x17, 0x3d,
			 0xdd, 0x2b, 0xa2, 0x22, 0x67, 0xf1, 0x8b, 0x5c, 0x79, 0x4d, 0x8e,
			 0xc4, 0x21, 0x95, 0x79, 0x7a, 0x8c, 0xfd, 0xaa, 0x21, 0xa8, 0x70,
			 0x6b, 0x67, 0x9a, 0x28, 0xf5, 0xda, 0x60, 0xa3, 0x5b, 0xcb, 0x75,
			 0x10, 0xc6, 0x00, 0xae, 0x06, 0x5a, 0xf5, 0x0d, 0x62, 0x2e, 0x6b,
			 0x29, 0xac, 0x28, 0x9a, 0x1e, 0x65, 0x55, 0xab, 0x52, 0x52, 0x9d,
			 0xe1, 0xa7, 0xbd, 0xc2, 0x39, 0x7a, 0xab, 0x0e, 0xec, 0x5c, 0xe2,
			 0xc5, 0xf2, 0x63, 0x3c, 0x05, 0x34, 0xd8, 0xa9, 0xec, 0xaf, 0xf1,
			 0x8c, 0x14, 0xf7, 0xea, 0x89, 0x86, 0x8f, 0x50, 0x9f, 0xdc, 0x7b,
			 0x21, 0x0c, 0x7f, 0x2a, 0xa4, 0x8f, 0x78, 0xcb, 0x07, 0x15, 0xb7,
			 0x0f, 0xff, 0xd6, 0x61, 0x0c, 0x5e, 0xa8, 0x19, 0x46, 0x7b, 0xb9,
			 0xa2, 0xea, 0x3d, 0xdb, 0xc7, 0x9f, 0x28, 0x86, 0x7e, 0x69, 0x6c,
			 0xb3, 0x21, 0xa6, 0x59, 0x4a, 0x8a, 0x73, 0x4f, 0xab, 0xd6, 0x87,
			 0x10, 0x0b, 0x7c, 0xa1, 0x2a, 0x70, 0xdd, 0xa6, 0xfc, 0x75, 0x09,
			 0x97, 0x87, 0xc5 },
			 .len = 256,
			 .sort = 1,
	},

		// 1
	{
		.e2 = { 0x01, 0x00, 0x01 },
		.e1 = { 0x41, 0x2a, 0xc0, 0x34, 0x13, 0x69, 0x05, 0xbe, 0x69, 0xaa, 0x41, 0xb7, 0x27, 0x77, 0x5c, 0x68, 0x44, 0x90, 0x1b, 0x6b, 0xc6, 0x28, 0xd7, 0x32, 0x0e, 0x95, 0xee, 0x7c, 0x1a, 0xa8, 0x13, 0x8e, 0xb3, 0xb6, 0x47, 0xaf, 0x48, 0xce, 0xd4, 0x03, 0xea, 0xd5, 0xed, 0x21, 0x77, 0xb2, 0x39, 0x2c, 0xc6, 0x3b, 0x85, 0xdd, 0xe7, 0xd3, 0x4e, 0x29, 0xe0, 0x0e, 0xdd, 0x52, 0x49, 0xd9, 0x2a, 0x92, 0xf3, 0xdd, 0x0d, 0x99, 0x14, 0x86, 0xb8, 0x89, 0x68, 0x71, 0x57, 0xc6, 0x47, 0x45, 0x4e, 0xf7, 0xa8, 0xf0, 0x1d, 0xad, 0x4e, 0x01, 0x1a, 0x14, 0xc2, 0x89, 0xe4, 0x08, 0xbc, 0xcd, 0x86, 0x6a, 0x6a, 0xc3, 0x24, 0xc5, 0xd5, 0x6a, 0xef, 0x30, 0xac, 0x7a, 0xc6, 0xd3, 0x4c, 0x51, 0xd1, 0xe9, 0x2a, 0xbf, 0x79, 0xfa, 0x1d, 0x91, 0x81, 0xb4, 0x79, 0x73, 0x39, 0x0f, 0xdd, 0x38, 0xa7, 0xb2, 0x8b, 0x00, 0xe3, 0xc7, 0xdc, 0x47, 0x46, 0x0c, 0x27, 0x7d, 0x99, 0xc1, 0x1d, 0xfd, 0x36, 0x16, 0x06, 0xaa, 0x76, 0x5a, 0x5a, 0x42, 0x5c, 0xdb, 0x75, 0x4d, 0xe0, 0xe0, 0xe0, 0xc0, 0x09, 0x2f, 0x57, 0xe9, 0x4c, 0x9a, 0xc0, 0xcf, 0x24, 0xcb, 0xaf, 0xe4, 0xda, 0x15, 0x3a, 0x74, 0x5f, 0x8e, 0xc2, 0x38, 0xfc, 0x9c, 0x2a, 0xd3, 0x74, 0x20, 0xce, 0x28, 0x4e, 0x53, 0xe3, 0xe6, 0xf1, 0xff, 0x34, 0x56, 0x7c, 0xf4, 0x45, 0xa2, 0x56, 0xdb, 0xcf, 0x18, 0x45, 0xf3, 0x0c, 0x7d, 0xd0, 0xa6, 0x6c, 0xd9, 0xcf, 0x5c, 0xfc, 0xab, 0x87, 0x35, 0x06, 0x40, 0xf4, 0xb8, 0x46, 0x16, 0xee, 0x31, 0x50, 0xf5, 0x24, 0xdc, 0xca, 0xf0, 0xec, 0xd4, 0x04, 0x52, 0x7b, 0x3c, 0xb5, 0x40, 0x2c, 0xb3, 0x07, 0x6f, 0x7a, 0x82, 0x39, 0x1b, 0x8e, 0xaa, 0x36, 0xfd, 0x39, 0x86, 0xde, 0xef, 0xbc, 0x04 },
		.n = { 0x4b, 0x86, 0xf8, 0x84, 0xfc, 0x68, 0xcc, 0xd2, 0x01, 0x14, 0xc7,
			 0xcb, 0x34, 0x48, 0xf0, 0xce, 0x9e, 0xd9, 0xae, 0x02, 0x19, 0xee,
			 0xe9, 0xaf, 0xb5, 0xcf, 0xcf, 0xba, 0xec, 0x39, 0x40, 0x03, 0xd2,
			 0x61, 0x50, 0x1f, 0x25, 0x04, 0x82, 0x44, 0x98, 0x45, 0xef, 0xed,
			 0xf5, 0xcd, 0x9d, 0x61, 0xa1, 0x30, 0x3e, 0xf6, 0x47, 0x37, 0x27,
			 0x2d, 0x56, 0xed, 0x3a, 0xe0, 0x6a, 0x69, 0x8a, 0xe2, 0x00, 0x06,
			 0x8d, 0x81, 0x07, 0x5e, 0xb0, 0xe9, 0xa1, 0x75, 0xf4, 0x62, 0x2f,
			 0xfe, 0x84, 0xce, 0x29, 0x8f, 0x6a, 0xe2, 0x9b, 0x4a, 0x3a, 0x62,
			 0xfc, 0x58, 0xb9, 0x6c, 0x0d, 0xd0, 0x18, 0x5d, 0x00, 0x13, 0xd4,
			 0x8a, 0x80, 0xda, 0xe1, 0xfa, 0x04, 0x3e, 0xd7, 0x49, 0x17, 0x3d,
			 0xdd, 0x2b, 0xa2, 0x22, 0x67, 0xf1, 0x8b, 0x5c, 0x79, 0x4d, 0x8e,
			 0xc4, 0x21, 0x95, 0x79, 0x7a, 0x8c, 0xfd, 0xaa, 0x21, 0xa8, 0x70,
			 0x6b, 0x67, 0x9a, 0x28, 0xf5, 0xda, 0x60, 0xa3, 0x5b, 0xcb, 0x75,
			 0x10, 0xc6, 0x00, 0xae, 0x06, 0x5a, 0xf5, 0x0d, 0x62, 0x2e, 0x6b,
			 0x29, 0xac, 0x28, 0x9a, 0x1e, 0x65, 0x55, 0xab, 0x52, 0x52, 0x9d,
			 0xe1, 0xa7, 0xbd, 0xc2, 0x39, 0x7a, 0xab, 0x0e, 0xec, 0x5c, 0xe2,
			 0xc5, 0xf2, 0x63, 0x3c, 0x05, 0x34, 0xd8, 0xa9, 0xec, 0xaf, 0xf1,
			 0x8c, 0x14, 0xf7, 0xea, 0x89, 0x86, 0x8f, 0x50, 0x9f, 0xdc, 0x7b,
			 0x21, 0x0c, 0x7f, 0x2a, 0xa4, 0x8f, 0x78, 0xcb, 0x07, 0x15, 0xb7,
			 0x0f, 0xff, 0xd6, 0x61, 0x0c, 0x5e, 0xa8, 0x19, 0x46, 0x7b, 0xb9,
			 0xa2, 0xea, 0x3d, 0xdb, 0xc7, 0x9f, 0x28, 0x86, 0x7e, 0x69, 0x6c,
			 0xb3, 0x21, 0xa6, 0x59, 0x4a, 0x8a, 0x73, 0x4f, 0xab, 0xd6, 0x87,
			 0x10, 0x0b, 0x7c, 0xa1, 0x2a, 0x70, 0xdd, 0xa6, 0xfc, 0x75, 0x09,
			 0x97, 0x87, 0xc5
		},
		.len = 256,
		.sort = 1,
	},

	{
		.e1 = {
			0x35,
		},
		.e2 = {
			0x22, 0x3a, 0x4b, 0xf9, 0x6c, 0x05, 0x82, 0x4a, 0xd4, 0xf1, 0x59, 0x5f, 0xd5, 0x93, 0x72,
			0x53, 0xca, 0x76, 0x5f, 0x18, 0xd4, 0xc5, 0xa5, 0x74, 0x1a, 0x5f, 0x94, 0x4e, 0xe5, 0xec,
			0x1b, 0xdb, 0x5f, 0xf0, 0x7e, 0x19, 0xde, 0x28, 0xdd, 0xba, 0x92, 0xaa, 0x04, 0x4c, 0xa8,
			0x43, 0x8c, 0x53, 0xe5, 0x39, 0xb6, 0x76, 0x25, 0x8e, 0x3c, 0x48, 0x1f, 0x49, 0x14, 0x07,
			0xc8, 0xfb, 0xa8, 0xd6, 0xc4, 0xb9, 0x54, 0xf1, 0xe7, 0x17, 0x8b, 0xbb, 0x57, 0x1f, 0x9f,
			0x07, 0x4f, 0xe0, 0xea, 0xad, 0xf3, 0x7d, 0xca, 0xd3, 0xd9, 0xf0, 0x04, 0x49, 0xe7, 0x75,
			0x89, 0x10, 0xdb, 0x86, 0xa0, 0xc8, 0x0a, 0xce, 0x37, 0x6d, 0xa0, 0x4d, 0x76, 0x70, 0xe0,
			0xfc, 0x20, 0xbf, 0xd6, 0x0f, 0x4b, 0xac, 0x26, 0x18, 0x28, 0x8a, 0x74, 0xdc, 0x03, 0x93,
			0x67, 0xde, 0x63, 0x2f, 0xbc, 0xb5, 0xa0, 0x7e, 0xa3, 0x27, 0x4e, 0xcb, 0xc2, 0xe3, 0xf2,
			0xde, 0x0f, 0x59, 0x60, 0x6e, 0x78, 0x04, 0xbb, 0x9a, 0xc6, 0xd0, 0x32, 0xf2, 0xcf, 0xb0,
			0x9d, 0x12, 0x99, 0x76, 0x09, 0xd3, 0x00, 0x98, 0xa2, 0x3f, 0x82, 0x8b, 0xfe, 0x0f, 0x88,
			0xd6, 0xb4, 0x6d, 0xa3, 0x93, 0x2e, 0x33, 0x10, 0xb0, 0xeb, 0xf4, 0xbd, 0xa1, 0x32, 0x6f,
			0x23, 0x27, 0x52, 0x20, 0x54, 0x7a, 0x99, 0x59, 0x04, 0x14, 0xa9, 0xff, 0x26, 0xb3, 0xb5,
			0x00, 0x0f, 0x71, 0x0f, 0x5c, 0xdd, 0xcb, 0x44, 0xf7, 0xee, 0x53, 0x83, 0x11, 0x88, 0x56,
			0x27, 0xa5, 0xa3, 0xdc, 0x95, 0xb1, 0x9f, 0xc7, 0x43, 0x96, 0xe6, 0x9d, 0x82, 0xa9, 0x7a,
			0x89, 0x01, 0xa7, 0x8b, 0x1e, 0xff, 0xba, 0xb4, 0xaf, 0x8a, 0x43, 0xb6, 0xf5, 0x79, 0xaf,
			0xa0, 0xc5, 0xd3, 0xb8, 0x7b, 0x1b, 0x62, 0x80, 0xb2, 0x9b, 0x48, 0x78, 0x41, 0x31, 0x26,
			0x45,
		},
		.n = {
			0xc9, 0x90, 0x31, 0x2e, 0x98, 0x92, 0x38, 0x2a, 0x74, 0x37, 0xf1, 0xdf, 0x06, 0x2b,
			0x68, 0x5f, 0x36, 0x80, 0x30, 0x04, 0x01, 0x6f, 0x79, 0x01, 0x0d, 0x16, 0x69, 0x5e, 0xd8,
			0x35, 0x87, 0x9a, 0x18, 0x88, 0x3b, 0xed, 0xaa, 0x7e, 0xe0, 0xd8, 0xed, 0xe9, 0x35, 0xc3,
			0x6d, 0x1c, 0x01, 0x7c, 0x45, 0xe2, 0x16, 0x0d, 0x16, 0x0c, 0xb8, 0x53, 0x62, 0xe7, 0x3d,
			0x11, 0x66, 0xad, 0x8c, 0xf0, 0xbf, 0x5f, 0xd7, 0xc9, 0x6d, 0x51, 0xc5, 0x16, 0x56, 0x64,
			0xe1, 0x63, 0xf2, 0xd7, 0x2d, 0x1c, 0xd2, 0xc8, 0x55, 0x18, 0x75, 0x30, 0x19, 0x41, 0x6f,
			0x7b, 0x43, 0x9c, 0x29, 0x35, 0x41, 0x0b, 0xcd, 0xda, 0xd4, 0xa2, 0x05, 0x56, 0x64, 0x26,
			0xf4, 0x05, 0xa4, 0x69, 0xb3, 0xaf, 0x68, 0x4b, 0x19, 0x38, 0xee, 0xbd, 0x93, 0xba, 0x4d,
			0xf2, 0x47, 0x3a, 0x0f, 0x35, 0x90, 0x2d, 0x94, 0xb2, 0xa4, 0x49, 0xbc, 0xfb, 0x27, 0x33,
			0x8a, 0x03, 0xc8, 0xa8, 0xc3, 0x19, 0x61, 0xb6, 0x1b, 0xb8, 0x92, 0x4e, 0xb3, 0xc6, 0x33,
			0x3a, 0x62, 0xf2, 0x22, 0x6b, 0xf9, 0xfa, 0x32, 0x06, 0x68, 0x51, 0x3f, 0x57, 0x68, 0xe0,
			0x53, 0xcf, 0xc8, 0xe0, 0x0e, 0x3c, 0x50, 0x8d, 0x52, 0x9b, 0x80, 0x60, 0x9c, 0xef, 0xad,
			0x64, 0x21, 0x27, 0x87, 0x14, 0xed, 0x5a, 0x9d, 0xc1, 0x2d, 0x30, 0x86, 0x5d, 0xe4, 0xa9,
			0x10, 0x9a, 0x44, 0x8d, 0x9c, 0xba, 0x0e, 0xa0, 0xbe, 0x4e, 0x4e, 0x07, 0xe8, 0x59, 0xe3,
			0x32, 0x31, 0xb0, 0xee, 0xae, 0x62, 0x5c, 0xd3, 0x0d, 0xce, 0x50, 0x31, 0x0c, 0xf2, 0xb5,
			0x72, 0x54, 0x86, 0xa4, 0x75, 0x0f, 0x82, 0x0c, 0xef, 0x7b, 0xf1, 0x10, 0x0f, 0x75, 0x57,
			0x4d, 0x6c, 0x30, 0xdf, 0x34, 0x91, 0xc1, 0xec, 0x45, 0x75, 0x67, 0xba, 0xc8, 0x48, 0xbc,
			0x3b, 0x9b,
		},
		.len = 256,
	},
	{
		.e2 = {
			0x35,
		},
		.e1 = {
			0x22, 0x3a, 0x4b, 0xf9, 0x6c, 0x05, 0x82, 0x4a, 0xd4, 0xf1, 0x59, 0x5f, 0xd5, 0x93, 0x72,
			0x53, 0xca, 0x76, 0x5f, 0x18, 0xd4, 0xc5, 0xa5, 0x74, 0x1a, 0x5f, 0x94, 0x4e, 0xe5, 0xec,
			0x1b, 0xdb, 0x5f, 0xf0, 0x7e, 0x19, 0xde, 0x28, 0xdd, 0xba, 0x92, 0xaa, 0x04, 0x4c, 0xa8,
			0x43, 0x8c, 0x53, 0xe5, 0x39, 0xb6, 0x76, 0x25, 0x8e, 0x3c, 0x48, 0x1f, 0x49, 0x14, 0x07,
			0xc8, 0xfb, 0xa8, 0xd6, 0xc4, 0xb9, 0x54, 0xf1, 0xe7, 0x17, 0x8b, 0xbb, 0x57, 0x1f, 0x9f,
			0x07, 0x4f, 0xe0, 0xea, 0xad, 0xf3, 0x7d, 0xca, 0xd3, 0xd9, 0xf0, 0x04, 0x49, 0xe7, 0x75,
			0x89, 0x10, 0xdb, 0x86, 0xa0, 0xc8, 0x0a, 0xce, 0x37, 0x6d, 0xa0, 0x4d, 0x76, 0x70, 0xe0,
			0xfc, 0x20, 0xbf, 0xd6, 0x0f, 0x4b, 0xac, 0x26, 0x18, 0x28, 0x8a, 0x74, 0xdc, 0x03, 0x93,
			0x67, 0xde, 0x63, 0x2f, 0xbc, 0xb5, 0xa0, 0x7e, 0xa3, 0x27, 0x4e, 0xcb, 0xc2, 0xe3, 0xf2,
			0xde, 0x0f, 0x59, 0x60, 0x6e, 0x78, 0x04, 0xbb, 0x9a, 0xc6, 0xd0, 0x32, 0xf2, 0xcf, 0xb0,
			0x9d, 0x12, 0x99, 0x76, 0x09, 0xd3, 0x00, 0x98, 0xa2, 0x3f, 0x82, 0x8b, 0xfe, 0x0f, 0x88,
			0xd6, 0xb4, 0x6d, 0xa3, 0x93, 0x2e, 0x33, 0x10, 0xb0, 0xeb, 0xf4, 0xbd, 0xa1, 0x32, 0x6f,
			0x23, 0x27, 0x52, 0x20, 0x54, 0x7a, 0x99, 0x59, 0x04, 0x14, 0xa9, 0xff, 0x26, 0xb3, 0xb5,
			0x00, 0x0f, 0x71, 0x0f, 0x5c, 0xdd, 0xcb, 0x44, 0xf7, 0xee, 0x53, 0x83, 0x11, 0x88, 0x56,
			0x27, 0xa5, 0xa3, 0xdc, 0x95, 0xb1, 0x9f, 0xc7, 0x43, 0x96, 0xe6, 0x9d, 0x82, 0xa9, 0x7a,
			0x89, 0x01, 0xa7, 0x8b, 0x1e, 0xff, 0xba, 0xb4, 0xaf, 0x8a, 0x43, 0xb6, 0xf5, 0x79, 0xaf,
			0xa0, 0xc5, 0xd3, 0xb8, 0x7b, 0x1b, 0x62, 0x80, 0xb2, 0x9b, 0x48, 0x78, 0x41, 0x31, 0x26,
			0x45,
		},
		.n = {
			0xc9, 0x90, 0x31, 0x2e, 0x98, 0x92, 0x38, 0x2a, 0x74, 0x37, 0xf1, 0xdf, 0x06, 0x2b,
			0x68, 0x5f, 0x36, 0x80, 0x30, 0x04, 0x01, 0x6f, 0x79, 0x01, 0x0d, 0x16, 0x69, 0x5e, 0xd8,
			0x35, 0x87, 0x9a, 0x18, 0x88, 0x3b, 0xed, 0xaa, 0x7e, 0xe0, 0xd8, 0xed, 0xe9, 0x35, 0xc3,
			0x6d, 0x1c, 0x01, 0x7c, 0x45, 0xe2, 0x16, 0x0d, 0x16, 0x0c, 0xb8, 0x53, 0x62, 0xe7, 0x3d,
			0x11, 0x66, 0xad, 0x8c, 0xf0, 0xbf, 0x5f, 0xd7, 0xc9, 0x6d, 0x51, 0xc5, 0x16, 0x56, 0x64,
			0xe1, 0x63, 0xf2, 0xd7, 0x2d, 0x1c, 0xd2, 0xc8, 0x55, 0x18, 0x75, 0x30, 0x19, 0x41, 0x6f,
			0x7b, 0x43, 0x9c, 0x29, 0x35, 0x41, 0x0b, 0xcd, 0xda, 0xd4, 0xa2, 0x05, 0x56, 0x64, 0x26,
			0xf4, 0x05, 0xa4, 0x69, 0xb3, 0xaf, 0x68, 0x4b, 0x19, 0x38, 0xee, 0xbd, 0x93, 0xba, 0x4d,
			0xf2, 0x47, 0x3a, 0x0f, 0x35, 0x90, 0x2d, 0x94, 0xb2, 0xa4, 0x49, 0xbc, 0xfb, 0x27, 0x33,
			0x8a, 0x03, 0xc8, 0xa8, 0xc3, 0x19, 0x61, 0xb6, 0x1b, 0xb8, 0x92, 0x4e, 0xb3, 0xc6, 0x33,
			0x3a, 0x62, 0xf2, 0x22, 0x6b, 0xf9, 0xfa, 0x32, 0x06, 0x68, 0x51, 0x3f, 0x57, 0x68, 0xe0,
			0x53, 0xcf, 0xc8, 0xe0, 0x0e, 0x3c, 0x50, 0x8d, 0x52, 0x9b, 0x80, 0x60, 0x9c, 0xef, 0xad,
			0x64, 0x21, 0x27, 0x87, 0x14, 0xed, 0x5a, 0x9d, 0xc1, 0x2d, 0x30, 0x86, 0x5d, 0xe4, 0xa9,
			0x10, 0x9a, 0x44, 0x8d, 0x9c, 0xba, 0x0e, 0xa0, 0xbe, 0x4e, 0x4e, 0x07, 0xe8, 0x59, 0xe3,
			0x32, 0x31, 0xb0, 0xee, 0xae, 0x62, 0x5c, 0xd3, 0x0d, 0xce, 0x50, 0x31, 0x0c, 0xf2, 0xb5,
			0x72, 0x54, 0x86, 0xa4, 0x75, 0x0f, 0x82, 0x0c, 0xef, 0x7b, 0xf1, 0x10, 0x0f, 0x75, 0x57,
			0x4d, 0x6c, 0x30, 0xdf, 0x34, 0x91, 0xc1, 0xec, 0x45, 0x75, 0x67, 0xba, 0xc8, 0x48, 0xbc,
			0x3b, 0x9b,
		},
		.len = 256,
	},


	// 2
	{
		.e1 = {0x01, 0x00, 0x01},
		.e2 = {
			0x93, 0x32, 0xa1, 0xc0, 0x9f, 0xda, 0x89, 0x28, 0x69, 0x30, 0x34, 0x8a, 0x5e, 0x1e,
			0xed, 0x56, 0xf9, 0x1e, 0xbd, 0x50, 0xfd, 0x7a, 0x35, 0xa0, 0x70, 0x04, 0x18, 0xbc, 0x79,
			0x71, 0xc1, 0xdb, 0x31, 0xca, 0x3b, 0x69, 0xe3, 0x31, 0xa0, 0x77, 0x75, 0xa8, 0xcc, 0x52,
			0x2d, 0x76, 0x0f, 0xda, 0x27, 0xcd, 0x70, 0xeb, 0x60, 0x66, 0xae, 0x38, 0xf4, 0xac, 0xc7,
			0x2c, 0x2d, 0x3d, 0xab, 0x08, 0x3a, 0xdc, 0x4c, 0xe7, 0x48, 0xc4, 0x81, 0xe9, 0xd4, 0xc6,
			0xe2, 0x61, 0xce, 0x30, 0x4b, 0x88, 0x7c, 0xb2, 0xaa, 0x55, 0x6f, 0xef, 0xa0, 0x7d, 0x1e,
			0x1e, 0x8a, 0x99, 0x84, 0x97, 0x8f, 0x27, 0xea, 0xb6, 0xba, 0x39, 0xd2, 0x59, 0x90, 0x65,
			0xef, 0xb1, 0xcd, 0xa0, 0xae, 0x34, 0xf1, 0x64, 0xd2, 0x7b, 0xa9, 0xe8, 0x12, 0xc5, 0x47,
			0x2f, 0xf6, 0x15, 0xff, 0xe9, 0x53, 0xbd, 0xa7, 0xe4, 0x5c, 0x65, 0x37, 0xea, 0xa8, 0xab,
			0xb2, 0x38, 0x0b, 0x73, 0xbc, 0xb8, 0x13, 0xea, 0xb8, 0x50, 0x72, 0x9a, 0x68, 0x3a, 0x09,
			0x3c, 0x79, 0x0e, 0x62, 0xef, 0xae, 0x95, 0xe7, 0x4e, 0xb3, 0x96, 0x9a, 0xe0, 0x90, 0xc0,
			0xb5, 0xb5, 0xae, 0x24, 0x38, 0xf0, 0x8a, 0x6a, 0xbc, 0x50, 0xe0, 0x16, 0xcf, 0xfd, 0x9e,
			0x63, 0xc7, 0xd2, 0x88, 0xd2, 0x49, 0xdf, 0x61, 0xdb, 0xea, 0xca, 0xac, 0x3a, 0x07, 0xbc,
			0x20, 0xda, 0x69, 0xe8, 0x5a, 0x8b, 0xca, 0xf8, 0x5d, 0xf3, 0xab, 0xcd, 0x7b, 0x8c, 0xd9,
			0x8c, 0x16, 0xa5, 0x0d, 0xfc, 0x0a, 0x81, 0x5e, 0x66, 0x50, 0x05, 0x27, 0xa4, 0x68, 0x9a,
			0x19, 0xee, 0xa1, 0x2e, 0xc0, 0x61, 0x08, 0xec, 0x76, 0x60, 0x67, 0x15, 0x84, 0x03, 0x48,
			0xfa, 0xcb, 0xc8, 0xf4, 0xef, 0x71, 0xff, 0x46, 0x49, 0x98, 0x87, 0x87, 0xa2, 0x0e, 0xda,
			0xf4, 0xb9,
		},
		.n  = {
			0xbb, 0x4c, 0xdf, 0x2f, 0xce, 0xe8, 0x82, 0x8e, 0x97, 0xa1, 0x3b, 0xb1, 0x38, 0xfb,
			0x66, 0x53, 0x2f, 0xcf, 0x0b, 0x37, 0x82, 0x20, 0x36, 0xaf, 0xfd, 0x65, 0xee, 0x7a, 0x2c,
			0x51, 0x31, 0x5d, 0x9d, 0x95, 0x59, 0xf0, 0x98, 0x45, 0x3e, 0xec, 0xf2, 0xf9, 0x50, 0x91,
			0xe6, 0x58, 0x12, 0x69, 0x52, 0x24, 0xc6, 0x48, 0x6c, 0xd7, 0x87, 0x79, 0xe4, 0xb3, 0x87,
			0x9f, 0x32, 0xdf, 0x05, 0xd6, 0xf6, 0xc3, 0x3e, 0xe8, 0x7e, 0x4e, 0x79, 0xd5, 0xfe, 0x62,
			0x19, 0xf5, 0x74, 0xa6, 0x8e, 0x72, 0x03, 0x11, 0x46, 0xf9, 0x04, 0x97, 0xcc, 0x40, 0x82,
			0x3e, 0x10, 0x5a, 0x56, 0x7a, 0xef, 0xb8, 0x28, 0x45, 0xf7, 0xc8, 0x1d, 0xa3, 0xee, 0xa4,
			0x12, 0xb5, 0x0e, 0xdb, 0xe1, 0x1c, 0xb3, 0xb7, 0xde, 0x7b, 0x6a, 0xb0, 0x29, 0xfa, 0x09,
			0x0a, 0xd6, 0x39, 0x42, 0x46, 0xdd, 0xb9, 0x5e, 0x72, 0xfe, 0x69, 0xf3, 0x27, 0xf0, 0x0f,
			0x6d, 0x42, 0xef, 0x81, 0xa1, 0x15, 0xc9, 0xed, 0xa3, 0x30, 0x14, 0xef, 0x76, 0x5e, 0xdd,
			0xb8, 0xa4, 0x5c, 0x71, 0x7a, 0xdf, 0x40, 0x66, 0x06, 0x3f, 0x80, 0x42, 0x2a, 0x4a, 0x90,
			0xe2, 0xa8, 0xeb, 0x9a, 0x51, 0x50, 0x10, 0x69, 0x92, 0x37, 0xca, 0x90, 0xce, 0x62, 0xe1,
			0x39, 0x27, 0x7a, 0xe2, 0x41, 0x66, 0x95, 0x16, 0xbc, 0x5e, 0x62, 0x69, 0x80, 0xc1, 0x80,
			0x56, 0x8b, 0x12, 0x7d, 0x16, 0x85, 0xea, 0x93, 0x54, 0xe5, 0x63, 0xed, 0xac, 0x31, 0xe6,
			0x57, 0x2e, 0xd1, 0x35, 0xd1, 0x4c, 0xed, 0x99, 0x38, 0x8f, 0xf5, 0x09, 0x92, 0x85, 0xe2,
			0xd8, 0x67, 0x01, 0x23, 0x26, 0xae, 0x59, 0x35, 0x2b, 0x2c, 0x09, 0xef, 0xf8, 0xe3, 0x1f,
			0xc7, 0x5f, 0x92, 0x19, 0x6e, 0x21, 0x87, 0x38, 0x40, 0x43, 0x0b, 0x02, 0x6c, 0x72, 0x6e,
			0xcc, 0xb3,
		},
		.len = 256,

	},

	// 3
	{
		.e2 = {0x01, 0x00, 0x01},
		.e1 = {
			0x93, 0x32, 0xa1, 0xc0, 0x9f, 0xda, 0x89, 0x28, 0x69, 0x30, 0x34, 0x8a, 0x5e, 0x1e,
			0xed, 0x56, 0xf9, 0x1e, 0xbd, 0x50, 0xfd, 0x7a, 0x35, 0xa0, 0x70, 0x04, 0x18, 0xbc, 0x79,
			0x71, 0xc1, 0xdb, 0x31, 0xca, 0x3b, 0x69, 0xe3, 0x31, 0xa0, 0x77, 0x75, 0xa8, 0xcc, 0x52,
			0x2d, 0x76, 0x0f, 0xda, 0x27, 0xcd, 0x70, 0xeb, 0x60, 0x66, 0xae, 0x38, 0xf4, 0xac, 0xc7,
			0x2c, 0x2d, 0x3d, 0xab, 0x08, 0x3a, 0xdc, 0x4c, 0xe7, 0x48, 0xc4, 0x81, 0xe9, 0xd4, 0xc6,
			0xe2, 0x61, 0xce, 0x30, 0x4b, 0x88, 0x7c, 0xb2, 0xaa, 0x55, 0x6f, 0xef, 0xa0, 0x7d, 0x1e,
			0x1e, 0x8a, 0x99, 0x84, 0x97, 0x8f, 0x27, 0xea, 0xb6, 0xba, 0x39, 0xd2, 0x59, 0x90, 0x65,
			0xef, 0xb1, 0xcd, 0xa0, 0xae, 0x34, 0xf1, 0x64, 0xd2, 0x7b, 0xa9, 0xe8, 0x12, 0xc5, 0x47,
			0x2f, 0xf6, 0x15, 0xff, 0xe9, 0x53, 0xbd, 0xa7, 0xe4, 0x5c, 0x65, 0x37, 0xea, 0xa8, 0xab,
			0xb2, 0x38, 0x0b, 0x73, 0xbc, 0xb8, 0x13, 0xea, 0xb8, 0x50, 0x72, 0x9a, 0x68, 0x3a, 0x09,
			0x3c, 0x79, 0x0e, 0x62, 0xef, 0xae, 0x95, 0xe7, 0x4e, 0xb3, 0x96, 0x9a, 0xe0, 0x90, 0xc0,
			0xb5, 0xb5, 0xae, 0x24, 0x38, 0xf0, 0x8a, 0x6a, 0xbc, 0x50, 0xe0, 0x16, 0xcf, 0xfd, 0x9e,
			0x63, 0xc7, 0xd2, 0x88, 0xd2, 0x49, 0xdf, 0x61, 0xdb, 0xea, 0xca, 0xac, 0x3a, 0x07, 0xbc,
			0x20, 0xda, 0x69, 0xe8, 0x5a, 0x8b, 0xca, 0xf8, 0x5d, 0xf3, 0xab, 0xcd, 0x7b, 0x8c, 0xd9,
			0x8c, 0x16, 0xa5, 0x0d, 0xfc, 0x0a, 0x81, 0x5e, 0x66, 0x50, 0x05, 0x27, 0xa4, 0x68, 0x9a,
			0x19, 0xee, 0xa1, 0x2e, 0xc0, 0x61, 0x08, 0xec, 0x76, 0x60, 0x67, 0x15, 0x84, 0x03, 0x48,
			0xfa, 0xcb, 0xc8, 0xf4, 0xef, 0x71, 0xff, 0x46, 0x49, 0x98, 0x87, 0x87, 0xa2, 0x0e, 0xda,
			0xf4, 0xb9,
		},
		.n	= {
			0xbb, 0x4c, 0xdf, 0x2f, 0xce, 0xe8, 0x82, 0x8e, 0x97, 0xa1, 0x3b, 0xb1, 0x38, 0xfb,
			0x66, 0x53, 0x2f, 0xcf, 0x0b, 0x37, 0x82, 0x20, 0x36, 0xaf, 0xfd, 0x65, 0xee, 0x7a, 0x2c,
			0x51, 0x31, 0x5d, 0x9d, 0x95, 0x59, 0xf0, 0x98, 0x45, 0x3e, 0xec, 0xf2, 0xf9, 0x50, 0x91,
			0xe6, 0x58, 0x12, 0x69, 0x52, 0x24, 0xc6, 0x48, 0x6c, 0xd7, 0x87, 0x79, 0xe4, 0xb3, 0x87,
			0x9f, 0x32, 0xdf, 0x05, 0xd6, 0xf6, 0xc3, 0x3e, 0xe8, 0x7e, 0x4e, 0x79, 0xd5, 0xfe, 0x62,
			0x19, 0xf5, 0x74, 0xa6, 0x8e, 0x72, 0x03, 0x11, 0x46, 0xf9, 0x04, 0x97, 0xcc, 0x40, 0x82,
			0x3e, 0x10, 0x5a, 0x56, 0x7a, 0xef, 0xb8, 0x28, 0x45, 0xf7, 0xc8, 0x1d, 0xa3, 0xee, 0xa4,
			0x12, 0xb5, 0x0e, 0xdb, 0xe1, 0x1c, 0xb3, 0xb7, 0xde, 0x7b, 0x6a, 0xb0, 0x29, 0xfa, 0x09,
			0x0a, 0xd6, 0x39, 0x42, 0x46, 0xdd, 0xb9, 0x5e, 0x72, 0xfe, 0x69, 0xf3, 0x27, 0xf0, 0x0f,
			0x6d, 0x42, 0xef, 0x81, 0xa1, 0x15, 0xc9, 0xed, 0xa3, 0x30, 0x14, 0xef, 0x76, 0x5e, 0xdd,
			0xb8, 0xa4, 0x5c, 0x71, 0x7a, 0xdf, 0x40, 0x66, 0x06, 0x3f, 0x80, 0x42, 0x2a, 0x4a, 0x90,
			0xe2, 0xa8, 0xeb, 0x9a, 0x51, 0x50, 0x10, 0x69, 0x92, 0x37, 0xca, 0x90, 0xce, 0x62, 0xe1,
			0x39, 0x27, 0x7a, 0xe2, 0x41, 0x66, 0x95, 0x16, 0xbc, 0x5e, 0x62, 0x69, 0x80, 0xc1, 0x80,
			0x56, 0x8b, 0x12, 0x7d, 0x16, 0x85, 0xea, 0x93, 0x54, 0xe5, 0x63, 0xed, 0xac, 0x31, 0xe6,
			0x57, 0x2e, 0xd1, 0x35, 0xd1, 0x4c, 0xed, 0x99, 0x38, 0x8f, 0xf5, 0x09, 0x92, 0x85, 0xe2,
			0xd8, 0x67, 0x01, 0x23, 0x26, 0xae, 0x59, 0x35, 0x2b, 0x2c, 0x09, 0xef, 0xf8, 0xe3, 0x1f,
			0xc7, 0x5f, 0x92, 0x19, 0x6e, 0x21, 0x87, 0x38, 0x40, 0x43, 0x0b, 0x02, 0x6c, 0x72, 0x6e,
			0xcc, 0xb3,
		},
		.len = 256,

	},
#if 1
	// 4
	{
		.e1 = {
			0x01,0x00,0x01,
		},
		.e2 = {
			0x75, 0xd5, 0x82, 0xa1, 0x8b, 0x10, 0x3f, 0xe6, 0xf0, 0x01, 0x4d, 0x46, 0xa0, 0xc1, 0x58,
			0xcc, 0x6b, 0xa0, 0x32, 0xab, 0xc7, 0x9c, 0x80, 0xc3, 0x5d, 0xdf, 0xb1, 0x77, 0x11, 0xef,
			0x50, 0xd9, 0xb9, 0x5f, 0x40, 0xe2, 0xdc, 0xd2, 0x9b, 0xb0, 0xed, 0xd5, 0xd4, 0x00, 0x0b,
			0x55, 0x84, 0xad, 0xe6, 0x54, 0x28, 0x8d, 0x88, 0x30, 0xc4, 0xf5, 0x13, 0xbb, 0x83, 0x23,
			0xcf, 0xbf, 0x65, 0xfe, 0x4c, 0xd2, 0x8e, 0xdf, 0x0a, 0xbd, 0x26, 0xae, 0x4d, 0x3c, 0x60,
			0xc0, 0xcf, 0x5a, 0xcd, 0x2c, 0x9e, 0xd4, 0xa0, 0xc9, 0x23, 0x38, 0xa9, 0xd9, 0x4b, 0x1f,
			0x45, 0x45, 0x40, 0x9b, 0xa5, 0xf7, 0xdf, 0x46, 0x01, 0x1a, 0x1b, 0xbe, 0x33, 0xa2, 0x00,
			0x6f, 0xe8, 0x00, 0xf4, 0xd4, 0x33, 0x76, 0x6e, 0x0a, 0x9f, 0x4c, 0xd8, 0xd7, 0x89, 0x64,
			0xe1, 0x2e, 0x83, 0xe1, 0x60, 0x9d, 0x3a, 0xc1,
		},
		.n = {
			0xca, 0x2a, 0x28, 0x37, 0xb0, 0x80, 0xa3, 0xc9, 0x04, 0xac, 0x37, 0x76, 0x92, 0xfe,
			0xf5, 0x4f, 0x24, 0xcd, 0xad, 0xb7, 0x3f, 0x6b, 0xa7, 0x14, 0x92, 0x69, 0xd7, 0xcb, 0x6d,
			0x6f, 0x76, 0x45, 0xce, 0x8f, 0xa2, 0x30, 0x92, 0x82, 0x91, 0x1d, 0xd3, 0x88, 0x43, 0xf7,
			0xdf, 0x7e, 0x5c, 0x8c, 0x16, 0x2e, 0xe4, 0x2d, 0xd1, 0x70, 0x33, 0x9d, 0xa6, 0x59, 0x15,
			0xe0, 0x6d, 0x64, 0xdd, 0xc4, 0x06, 0x90, 0x1e, 0xc4, 0xcd, 0x44, 0xf3, 0x4c, 0x33, 0x5b,
			0x0c, 0x97, 0x5d, 0x40, 0x2b, 0xca, 0x75, 0x16, 0x9a, 0x71, 0x5a, 0xfb, 0x22, 0x26, 0xcb,
			0x47, 0xd0, 0x8b, 0x43, 0xd2, 0x9d, 0x53, 0x17, 0x6b, 0xe8, 0x7f, 0xc3, 0x3b, 0xe8, 0x67,
			0x31, 0xe7, 0x33, 0xb3, 0xd7, 0x76, 0xc2, 0x58, 0xfa, 0x8c, 0x2b, 0x80, 0x17, 0x23, 0xef,
			0x7e, 0x67, 0xdd, 0xee, 0xca, 0x8c, 0xa1, 0x22, 0xc7,
		},
		.len = 128,
	},
	{
		.e2 = {
			0x01,0x00,0x01,
		},
		.e1 = {
			0x75, 0xd5, 0x82, 0xa1, 0x8b, 0x10, 0x3f, 0xe6, 0xf0, 0x01, 0x4d, 0x46, 0xa0, 0xc1, 0x58,
			0xcc, 0x6b, 0xa0, 0x32, 0xab, 0xc7, 0x9c, 0x80, 0xc3, 0x5d, 0xdf, 0xb1, 0x77, 0x11, 0xef,
			0x50, 0xd9, 0xb9, 0x5f, 0x40, 0xe2, 0xdc, 0xd2, 0x9b, 0xb0, 0xed, 0xd5, 0xd4, 0x00, 0x0b,
			0x55, 0x84, 0xad, 0xe6, 0x54, 0x28, 0x8d, 0x88, 0x30, 0xc4, 0xf5, 0x13, 0xbb, 0x83, 0x23,
			0xcf, 0xbf, 0x65, 0xfe, 0x4c, 0xd2, 0x8e, 0xdf, 0x0a, 0xbd, 0x26, 0xae, 0x4d, 0x3c, 0x60,
			0xc0, 0xcf, 0x5a, 0xcd, 0x2c, 0x9e, 0xd4, 0xa0, 0xc9, 0x23, 0x38, 0xa9, 0xd9, 0x4b, 0x1f,
			0x45, 0x45, 0x40, 0x9b, 0xa5, 0xf7, 0xdf, 0x46, 0x01, 0x1a, 0x1b, 0xbe, 0x33, 0xa2, 0x00,
			0x6f, 0xe8, 0x00, 0xf4, 0xd4, 0x33, 0x76, 0x6e, 0x0a, 0x9f, 0x4c, 0xd8, 0xd7, 0x89, 0x64,
			0xe1, 0x2e, 0x83, 0xe1, 0x60, 0x9d, 0x3a, 0xc1,
		},
		.n = {
			0xca, 0x2a, 0x28, 0x37, 0xb0, 0x80, 0xa3, 0xc9, 0x04, 0xac, 0x37, 0x76, 0x92, 0xfe,
			0xf5, 0x4f, 0x24, 0xcd, 0xad, 0xb7, 0x3f, 0x6b, 0xa7, 0x14, 0x92, 0x69, 0xd7, 0xcb, 0x6d,
			0x6f, 0x76, 0x45, 0xce, 0x8f, 0xa2, 0x30, 0x92, 0x82, 0x91, 0x1d, 0xd3, 0x88, 0x43, 0xf7,
			0xdf, 0x7e, 0x5c, 0x8c, 0x16, 0x2e, 0xe4, 0x2d, 0xd1, 0x70, 0x33, 0x9d, 0xa6, 0x59, 0x15,
			0xe0, 0x6d, 0x64, 0xdd, 0xc4, 0x06, 0x90, 0x1e, 0xc4, 0xcd, 0x44, 0xf3, 0x4c, 0x33, 0x5b,
			0x0c, 0x97, 0x5d, 0x40, 0x2b, 0xca, 0x75, 0x16, 0x9a, 0x71, 0x5a, 0xfb, 0x22, 0x26, 0xcb,
			0x47, 0xd0, 0x8b, 0x43, 0xd2, 0x9d, 0x53, 0x17, 0x6b, 0xe8, 0x7f, 0xc3, 0x3b, 0xe8, 0x67,
			0x31, 0xe7, 0x33, 0xb3, 0xd7, 0x76, 0xc2, 0x58, 0xfa, 0x8c, 0x2b, 0x80, 0x17, 0x23, 0xef,
			0x7e, 0x67, 0xdd, 0xee, 0xca, 0x8c, 0xa1, 0x22, 0xc7,
		},
		.len = 128,
	},
#endif
	{
		.e1 = {
			0x01,0x00,0x01,
		},
		.e2 = {
			0xab, 0x60, 0x07, 0x69, 0xf5, 0xe4, 0xc5, 0xa4, 0xda, 0x82, 0x36, 0x84, 0x09, 0xda,
			0x93, 0x34, 0x6f, 0x96, 0xd0, 0x65, 0x94, 0x47, 0x92, 0x9e, 0xa4, 0xe9, 0xd7, 0x75, 0x7d,
			0xd2, 0x96, 0x1a, 0xe2, 0xe9, 0xa0, 0x8a, 0xc8, 0x70, 0x5c, 0x9e, 0xde, 0x1a, 0xc6, 0xa3,
			0xde, 0x25, 0x0f, 0x7f, 0xff, 0xd1, 0xed, 0xb1, 0x28, 0x14, 0x7e, 0x18, 0x85, 0xdf, 0xef,
			0x83, 0x06, 0xed, 0xf5, 0x91,
		},

		.n = {
			0xcc, 0x8c, 0xb4, 0x33, 0x16, 0x34, 0x9b, 0x94, 0xa7, 0xa7, 0x4e, 0xef, 0x45, 0xf2,
			0x85, 0x7c, 0xd5, 0x53, 0xa4, 0x73, 0xb8, 0xf8, 0x4a, 0xec, 0xc5, 0x33, 0x66, 0x40, 0x5d,
			0x6f, 0x09, 0xbf, 0xb3, 0x4d, 0x5f, 0x16, 0xb4, 0xe9, 0x48, 0x52, 0x64, 0x82, 0xc4, 0x24,
			0x17, 0x94, 0x12, 0x1f, 0x66, 0x51, 0xea, 0x64, 0xc7, 0x7c, 0x15, 0x10, 0xa4, 0x2b, 0x0e,
			0x83, 0xdc, 0x7e, 0x8d, 0xcd,
		},
		.len = 64,
	},

	{
		.e2 = {
			0x01,0x00,0x01,
		},
		.e1 = {
			0xab, 0x60, 0x07, 0x69, 0xf5, 0xe4, 0xc5, 0xa4, 0xda, 0x82, 0x36, 0x84, 0x09, 0xda,
			0x93, 0x34, 0x6f, 0x96, 0xd0, 0x65, 0x94, 0x47, 0x92, 0x9e, 0xa4, 0xe9, 0xd7, 0x75, 0x7d,
			0xd2, 0x96, 0x1a, 0xe2, 0xe9, 0xa0, 0x8a, 0xc8, 0x70, 0x5c, 0x9e, 0xde, 0x1a, 0xc6, 0xa3,
			0xde, 0x25, 0x0f, 0x7f, 0xff, 0xd1, 0xed, 0xb1, 0x28, 0x14, 0x7e, 0x18, 0x85, 0xdf, 0xef,
			0x83, 0x06, 0xed, 0xf5, 0x91,
		},

		.n = {
			0xcc, 0x8c, 0xb4, 0x33, 0x16, 0x34, 0x9b, 0x94, 0xa7, 0xa7, 0x4e, 0xef, 0x45, 0xf2,
			0x85, 0x7c, 0xd5, 0x53, 0xa4, 0x73, 0xb8, 0xf8, 0x4a, 0xec, 0xc5, 0x33, 0x66, 0x40, 0x5d,
			0x6f, 0x09, 0xbf, 0xb3, 0x4d, 0x5f, 0x16, 0xb4, 0xe9, 0x48, 0x52, 0x64, 0x82, 0xc4, 0x24,
			0x17, 0x94, 0x12, 0x1f, 0x66, 0x51, 0xea, 0x64, 0xc7, 0x7c, 0x15, 0x10, 0xa4, 0x2b, 0x0e,
			0x83, 0xdc, 0x7e, 0x8d, 0xcd,
		},
		.len = 64,
	},
	{
		.e1 = {
			0x01,0x00,0x01,
		},
		.e2 = {
			0x94, 0x39, 0xa6, 0x92, 0xf7, 0x1c, 0x69, 0x15, 0x7c, 0x5c, 0x04, 0x58, 0xbc, 0x4f,
			0x6f, 0xc9, 0x4f, 0x0a, 0x5c, 0xee, 0xd9, 0xa1, 0x62, 0x06, 0x98, 0x40, 0x00, 0x80, 0x72,
			0xb8, 0xe1, 0xa1,
		},
		.n = {
			0xc2, 0xad, 0x8d, 0xd5, 0x01, 0x85, 0x40, 0x7e, 0x46, 0xa1, 0xdd, 0xd8, 0x8d, 0x06,
			0x39, 0x41, 0x58, 0xbd, 0x2e, 0x4c, 0x27, 0xd1, 0xd9, 0x04, 0xd5, 0x24, 0x3b, 0x59, 0x7a,
			0x4c, 0xaa, 0x0d,
		},
		.len = 32,
	},

	{
		.e2 = {
			0x01,0x00,0x01,
		},
		.e1 = {
			0x94, 0x39, 0xa6, 0x92, 0xf7, 0x1c, 0x69, 0x15, 0x7c, 0x5c, 0x04, 0x58, 0xbc, 0x4f,
			0x6f, 0xc9, 0x4f, 0x0a, 0x5c, 0xee, 0xd9, 0xa1, 0x62, 0x06, 0x98, 0x40, 0x00, 0x80, 0x72,
			0xb8, 0xe1, 0xa1,
		},
		.n = {
			0xc2, 0xad, 0x8d, 0xd5, 0x01, 0x85, 0x40, 0x7e, 0x46, 0xa1, 0xdd, 0xd8, 0x8d, 0x06,
			0x39, 0x41, 0x58, 0xbd, 0x2e, 0x4c, 0x27, 0xd1, 0xd9, 0x04, 0xd5, 0x24, 0x3b, 0x59, 0x7a,
			0x4c, 0xaa, 0x0d,
		},
		.len = 32,
	},
	{
		.e1 = {
			0x29, 0x99, 0x7d, 0x25,
		},

		.e2 = {
			0xb7, 0x7b, 0x10, 0x49, 0x2c, 0x0a, 0xfd, 0x82, 0xcd, 0x8c, 0xf8, 0x4f, 0x8e, 0xd5,
			0x79, 0x45, 0x0c, 0x76, 0xbe, 0x83, 0xae, 0xef, 0xb5, 0xad, 0x87, 0x8c, 0x80, 0x66, 0xea,
			0xdd, 0xb3, 0x38, 0x2c, 0x28, 0x15, 0xdd, 0xfb, 0x2a, 0x52, 0x40, 0xb0, 0xcb, 0x06, 0xdf,
			0x3a, 0x21, 0x72, 0x28, 0xdb, 0x78, 0xba, 0x4b, 0xe9, 0x5c, 0x3c, 0x0f, 0x12, 0x90, 0x85,
			0xd0, 0xe8, 0x84, 0xfe, 0x9a, 0x20, 0x5f, 0x59, 0x16, 0xc2, 0xdd, 0x2a, 0x32, 0x32, 0x66,
			0x83, 0x22, 0xf7, 0x81, 0x6f, 0xc1, 0x4d, 0x1a, 0x08, 0xb3, 0xb2, 0x98, 0xb8, 0xc0, 0xa1,
			0x0a, 0x6d, 0x73, 0x99, 0xfb, 0x38, 0x95, 0xc7, 0x61, 0xfa, 0xea, 0xdb, 0x3e, 0x5c, 0x96,
			0xce, 0x17, 0xca, 0xad, 0x88, 0x85, 0xb8, 0x72, 0xcc, 0xa4, 0xa8, 0x32, 0xb3, 0x19, 0xf7,
			0xa9, 0x1f, 0xcd, 0xa0, 0x5f, 0x28, 0x26, 0xab, 0xc1, 0x02, 0xcc, 0xa4, 0x29, 0x4a, 0x6e,
			0xdf, 0x57, 0x46, 0x0f, 0x7f, 0xa7, 0xbe, 0xef, 0x07, 0x92, 0xb6, 0xe5, 0x39, 0xa1, 0x42,
			0x35, 0x26, 0x9b, 0x6f, 0xd6, 0x9f, 0xc6, 0x0f, 0x57, 0xfa, 0xc1, 0x7c, 0xf5, 0x6d, 0x66,
			0x7d, 0x22, 0xf4, 0x4a, 0xc0, 0x63, 0x5f, 0xb2, 0x2b, 0xea, 0x37, 0xf6, 0x80, 0xce, 0x6e,
			0xf1, 0x4c, 0x1d, 0xab, 0x86, 0x4b, 0x72, 0x62, 0xb5, 0xb1, 0x71, 0x8b, 0x75, 0xff, 0xd0,
			0x24, 0x5e, 0xa8, 0x97, 0x92, 0x5f, 0xbd, 0xb8, 0x39, 0x15, 0x0f, 0x26, 0x74, 0x1b, 0x78,
			0x37, 0x16, 0xb1, 0xee, 0xd1, 0x80, 0xe8, 0x61, 0xe3, 0x5a, 0x72, 0x12, 0x6d, 0x38, 0x44,
			0x80, 0x00, 0x51, 0xa1, 0x92, 0x8c, 0x9b, 0x60, 0x63, 0x19, 0x09, 0x16, 0x0e, 0xda, 0x34,
			0x1e, 0x69, 0x31, 0xc3, 0x2a, 0xa9, 0x9a, 0xaf, 0x0f, 0x36, 0xcc, 0x38, 0xde, 0x2e, 0xb6,
			0x0a, 0xe9,
		},
		.n = {
			0xe4, 0x8b, 0xb8, 0x04, 0x9c, 0x4c, 0xfd, 0xa2, 0x0c, 0x2c, 0xb2, 0x21, 0xa1, 0x79,
			0xbd, 0xd0, 0x67, 0xfa, 0x19, 0xd5, 0xd7, 0x7e, 0x2e, 0x63, 0xe3, 0x4a, 0xf8, 0x0f, 0x3c,
			0x21, 0x86, 0x20, 0xee, 0x79, 0x3d, 0xf9, 0x3f, 0x4d, 0x88, 0xfe, 0x54, 0xee, 0xde, 0x18,
			0xf1, 0x20, 0x06, 0xa7, 0x60, 0x8e, 0x68, 0x5b, 0x83, 0x65, 0x19, 0xa3, 0xc2, 0x26, 0xa8,
			0xbb, 0xd7, 0xa6, 0x04, 0x99, 0x67, 0x87, 0xec, 0xc3, 0x57, 0x37, 0x9f, 0xb9, 0xc3, 0xd7,
			0x3d, 0xc5, 0x17, 0x4e, 0x0b, 0x67, 0xcd, 0x70, 0x82, 0x24, 0x31, 0x0e, 0x83, 0xab, 0xa0,
			0xd4, 0x63, 0xc1, 0xed, 0x95, 0xf4, 0x04, 0xdf, 0xc0, 0x45, 0x3b, 0xfe, 0xe7, 0xa6, 0x17,
			0x7d, 0x3c, 0xb3, 0xfb, 0x72, 0xff, 0x46, 0x99, 0xe4, 0x95, 0xe1, 0xad, 0xb8, 0x41, 0x5b,
			0x75, 0xa4, 0x5f, 0xba, 0xb2, 0xbc, 0xe6, 0xfe, 0x4b, 0x74, 0x07, 0xe6, 0xfc, 0xf0, 0xb2,
			0xe1, 0x0e, 0x63, 0x65, 0x41, 0x55, 0x66, 0xc2, 0xc4, 0x4a, 0xa8, 0x4d, 0x0c, 0x2d, 0xd3,
			0x37, 0x62, 0x4b, 0x1a, 0x00, 0x98, 0xc7, 0x63, 0xea, 0x04, 0xf7, 0xff, 0x0c, 0xff, 0x50,
			0x48, 0x2e, 0x99, 0x50, 0x8a, 0xaf, 0x23, 0x3f, 0xff, 0x05, 0x0d, 0x0b, 0xa1, 0xf4, 0x2d,
			0xd3, 0x0a, 0xfd, 0xf7, 0x08, 0xfc, 0x84, 0xc4, 0xdf, 0x6a, 0xc9, 0xd1, 0x1d, 0xba, 0xb5,
			0x28, 0xd4, 0x4a, 0x7c, 0x83, 0x99, 0x04, 0xbe, 0x96, 0x97, 0x21, 0x3c, 0xa9, 0xf0, 0xff,
			0xbe, 0xcd, 0xc8, 0x4d, 0x10, 0x9b, 0x9c, 0xf1, 0x63, 0x68, 0xf2, 0x22, 0x03, 0xce, 0xc7,
			0x80, 0x50, 0x1f, 0xdb, 0xdd, 0x41, 0x10, 0x59, 0xe0, 0x12, 0xa4, 0xc4, 0x46, 0x47, 0x62,
			0xa3, 0xe0, 0x14, 0x19, 0xe6, 0x80, 0x2b, 0x28, 0x42, 0x85, 0x69, 0x34, 0xe0, 0x55, 0xb8,
			0x5f, 0x0b,
		},
		.len  = 256,
	},
	{
			.e2 = {
				0x29, 0x99, 0x7d, 0x25,
			},

			.e1 = {
				0xb7, 0x7b, 0x10, 0x49, 0x2c, 0x0a, 0xfd, 0x82, 0xcd, 0x8c, 0xf8, 0x4f, 0x8e, 0xd5,
				0x79, 0x45, 0x0c, 0x76, 0xbe, 0x83, 0xae, 0xef, 0xb5, 0xad, 0x87, 0x8c, 0x80, 0x66, 0xea,
				0xdd, 0xb3, 0x38, 0x2c, 0x28, 0x15, 0xdd, 0xfb, 0x2a, 0x52, 0x40, 0xb0, 0xcb, 0x06, 0xdf,
				0x3a, 0x21, 0x72, 0x28, 0xdb, 0x78, 0xba, 0x4b, 0xe9, 0x5c, 0x3c, 0x0f, 0x12, 0x90, 0x85,
				0xd0, 0xe8, 0x84, 0xfe, 0x9a, 0x20, 0x5f, 0x59, 0x16, 0xc2, 0xdd, 0x2a, 0x32, 0x32, 0x66,
				0x83, 0x22, 0xf7, 0x81, 0x6f, 0xc1, 0x4d, 0x1a, 0x08, 0xb3, 0xb2, 0x98, 0xb8, 0xc0, 0xa1,
				0x0a, 0x6d, 0x73, 0x99, 0xfb, 0x38, 0x95, 0xc7, 0x61, 0xfa, 0xea, 0xdb, 0x3e, 0x5c, 0x96,
				0xce, 0x17, 0xca, 0xad, 0x88, 0x85, 0xb8, 0x72, 0xcc, 0xa4, 0xa8, 0x32, 0xb3, 0x19, 0xf7,
				0xa9, 0x1f, 0xcd, 0xa0, 0x5f, 0x28, 0x26, 0xab, 0xc1, 0x02, 0xcc, 0xa4, 0x29, 0x4a, 0x6e,
				0xdf, 0x57, 0x46, 0x0f, 0x7f, 0xa7, 0xbe, 0xef, 0x07, 0x92, 0xb6, 0xe5, 0x39, 0xa1, 0x42,
				0x35, 0x26, 0x9b, 0x6f, 0xd6, 0x9f, 0xc6, 0x0f, 0x57, 0xfa, 0xc1, 0x7c, 0xf5, 0x6d, 0x66,
				0x7d, 0x22, 0xf4, 0x4a, 0xc0, 0x63, 0x5f, 0xb2, 0x2b, 0xea, 0x37, 0xf6, 0x80, 0xce, 0x6e,
				0xf1, 0x4c, 0x1d, 0xab, 0x86, 0x4b, 0x72, 0x62, 0xb5, 0xb1, 0x71, 0x8b, 0x75, 0xff, 0xd0,
				0x24, 0x5e, 0xa8, 0x97, 0x92, 0x5f, 0xbd, 0xb8, 0x39, 0x15, 0x0f, 0x26, 0x74, 0x1b, 0x78,
				0x37, 0x16, 0xb1, 0xee, 0xd1, 0x80, 0xe8, 0x61, 0xe3, 0x5a, 0x72, 0x12, 0x6d, 0x38, 0x44,
				0x80, 0x00, 0x51, 0xa1, 0x92, 0x8c, 0x9b, 0x60, 0x63, 0x19, 0x09, 0x16, 0x0e, 0xda, 0x34,
				0x1e, 0x69, 0x31, 0xc3, 0x2a, 0xa9, 0x9a, 0xaf, 0x0f, 0x36, 0xcc, 0x38, 0xde, 0x2e, 0xb6,
				0x0a, 0xe9,
			},
			.n = {
				0xe4, 0x8b, 0xb8, 0x04, 0x9c, 0x4c, 0xfd, 0xa2, 0x0c, 0x2c, 0xb2, 0x21, 0xa1, 0x79,
				0xbd, 0xd0, 0x67, 0xfa, 0x19, 0xd5, 0xd7, 0x7e, 0x2e, 0x63, 0xe3, 0x4a, 0xf8, 0x0f, 0x3c,
				0x21, 0x86, 0x20, 0xee, 0x79, 0x3d, 0xf9, 0x3f, 0x4d, 0x88, 0xfe, 0x54, 0xee, 0xde, 0x18,
				0xf1, 0x20, 0x06, 0xa7, 0x60, 0x8e, 0x68, 0x5b, 0x83, 0x65, 0x19, 0xa3, 0xc2, 0x26, 0xa8,
				0xbb, 0xd7, 0xa6, 0x04, 0x99, 0x67, 0x87, 0xec, 0xc3, 0x57, 0x37, 0x9f, 0xb9, 0xc3, 0xd7,
				0x3d, 0xc5, 0x17, 0x4e, 0x0b, 0x67, 0xcd, 0x70, 0x82, 0x24, 0x31, 0x0e, 0x83, 0xab, 0xa0,
				0xd4, 0x63, 0xc1, 0xed, 0x95, 0xf4, 0x04, 0xdf, 0xc0, 0x45, 0x3b, 0xfe, 0xe7, 0xa6, 0x17,
				0x7d, 0x3c, 0xb3, 0xfb, 0x72, 0xff, 0x46, 0x99, 0xe4, 0x95, 0xe1, 0xad, 0xb8, 0x41, 0x5b,
				0x75, 0xa4, 0x5f, 0xba, 0xb2, 0xbc, 0xe6, 0xfe, 0x4b, 0x74, 0x07, 0xe6, 0xfc, 0xf0, 0xb2,
				0xe1, 0x0e, 0x63, 0x65, 0x41, 0x55, 0x66, 0xc2, 0xc4, 0x4a, 0xa8, 0x4d, 0x0c, 0x2d, 0xd3,
				0x37, 0x62, 0x4b, 0x1a, 0x00, 0x98, 0xc7, 0x63, 0xea, 0x04, 0xf7, 0xff, 0x0c, 0xff, 0x50,
				0x48, 0x2e, 0x99, 0x50, 0x8a, 0xaf, 0x23, 0x3f, 0xff, 0x05, 0x0d, 0x0b, 0xa1, 0xf4, 0x2d,
				0xd3, 0x0a, 0xfd, 0xf7, 0x08, 0xfc, 0x84, 0xc4, 0xdf, 0x6a, 0xc9, 0xd1, 0x1d, 0xba, 0xb5,
				0x28, 0xd4, 0x4a, 0x7c, 0x83, 0x99, 0x04, 0xbe, 0x96, 0x97, 0x21, 0x3c, 0xa9, 0xf0, 0xff,
				0xbe, 0xcd, 0xc8, 0x4d, 0x10, 0x9b, 0x9c, 0xf1, 0x63, 0x68, 0xf2, 0x22, 0x03, 0xce, 0xc7,
				0x80, 0x50, 0x1f, 0xdb, 0xdd, 0x41, 0x10, 0x59, 0xe0, 0x12, 0xa4, 0xc4, 0x46, 0x47, 0x62,
				0xa3, 0xe0, 0x14, 0x19, 0xe6, 0x80, 0x2b, 0x28, 0x42, 0x85, 0x69, 0x34, 0xe0, 0x55, 0xb8,
				0x5f, 0x0b,
			},
			.len  = 256,
		},

#if 0
	{
		.e1 = {
			0x01,0x00,0x01,
		},
		.e2 = {
			0xa1, 0x04, 0x4b, 0x7e, 0x17, 0x03, 0x8a, 0x09, 0x39, 0xf8, 0xbc, 0xb2, 0xff, 0x09,
			0xb2, 0xd9,
		},
		.n = {
			0xa4, 0x05, 0x20, 0x85, 0xb4, 0xbb, 0x19, 0x5a, 0x13, 0x94, 0x77, 0xb7, 0xdb, 0x34,
			0x67, 0x73,
		},
		.len = 16,
	},

	{
		.e2 = {
			0x01,0x00,0x01,
		},
		.e1 = {
			0xa1, 0x04, 0x4b, 0x7e, 0x17, 0x03, 0x8a, 0x09, 0x39, 0xf8, 0xbc, 0xb2, 0xff, 0x09,
			0xb2, 0xd9,
		},
		.n = {
			0xa4, 0x05, 0x20, 0x85, 0xb4, 0xbb, 0x19, 0x5a, 0x13, 0x94, 0x77, 0xb7, 0xdb, 0x34,
			0x67, 0x73,
		},
		.len = 16,
	},

	{
		.e1 = {
			0x01,0x00,0x01,
		},
		.e2 = {
			0x9c, 0x65, 0xc7, 0x24, 0x11, 0xd6, 0xf0, 0xde, 0xce, 0x04, 0x43, 0x19, 0x78, 0x4c,
			0x8f, 0xe9,
		},
		.n = {
			0xa8, 0xab, 0x2f, 0x2d, 0x56, 0x33, 0x25, 0x16, 0xe5, 0xb4, 0x93, 0x71, 0xe9, 0xb4,
			0xc2, 0x87,
		},

		.len = 16,
	},

	{
		.e2 = {
			0x01,0x00,0x01,
		},
		.e1 = {
			0x9c, 0x65, 0xc7, 0x24, 0x11, 0xd6, 0xf0, 0xde, 0xce, 0x04, 0x43, 0x19, 0x78, 0x4c,
			0x8f, 0xe9,
		},
		.n = {
			0xa8, 0xab, 0x2f, 0x2d, 0x56, 0x33, 0x25, 0x16, 0xe5, 0xb4, 0x93, 0x71, 0xe9, 0xb4,
			0xc2, 0x87,
		},
		.len = 16,
	},
	{
		.e1 = {
			0x01,0x00,0x01,
		},
		.e2 = {
			0x57, 0xc9, 0x23, 0x38, 0xdb, 0x16, 0xc0, 0xb1,
		},
		.n = {
			0x57, 0xc9, 0x23, 0x38, 0xdb, 0x16, 0xc0, 0xb1,
		},
		.len = 8,
	},

	{
		.e2 = {
			0x01,0x00,0x01,
		},
		.e1 = {
			0x57, 0xc9, 0x23, 0x38, 0xdb, 0x16, 0xc0, 0xb1,
		},
		.n = {
			0x57, 0xc9, 0x23, 0x38, 0xdb, 0x16, 0xc0, 0xb1,
		},
		.len = 8,
	},
#endif

};


/*c = m^e % n */
#if 1
char g_base[2048/8] = { 0xcd, 0xab, 0x23, 0x31, 0x02 };
char g_exp[2048/8] = { 0x01, 0x00, 0x01 };
char g_mode[] = { 0x4b, 0x86, 0xf8, 0x84, 0xfc, 0x68, 0xcc, 0xd2, 0x01, 0x14, 0xc7,
			 0xcb, 0x34, 0x48, 0xf0, 0xce, 0x9e, 0xd9, 0xae, 0x02, 0x19, 0xee,
			 0xe9, 0xaf, 0xb5, 0xcf, 0xcf, 0xba, 0xec, 0x39, 0x40, 0x03, 0xd2,
			 0x61, 0x50, 0x1f, 0x25, 0x04, 0x82, 0x44, 0x98, 0x45, 0xef, 0xed,
			 0xf5, 0xcd, 0x9d, 0x61, 0xa1, 0x30, 0x3e, 0xf6, 0x47, 0x37, 0x27,
			 0x2d, 0x56, 0xed, 0x3a, 0xe0, 0x6a, 0x69, 0x8a, 0xe2, 0x00, 0x06,
			 0x8d, 0x81, 0x07, 0x5e, 0xb0, 0xe9, 0xa1, 0x75, 0xf4, 0x62, 0x2f,
			 0xfe, 0x84, 0xce, 0x29, 0x8f, 0x6a, 0xe2, 0x9b, 0x4a, 0x3a, 0x62,
			 0xfc, 0x58, 0xb9, 0x6c, 0x0d, 0xd0, 0x18, 0x5d, 0x00, 0x13, 0xd4,
			 0x8a, 0x80, 0xda, 0xe1, 0xfa, 0x04, 0x3e, 0xd7, 0x49, 0x17, 0x3d,
			 0xdd, 0x2b, 0xa2, 0x22, 0x67, 0xf1, 0x8b, 0x5c, 0x79, 0x4d, 0x8e,
			 0xc4, 0x21, 0x95, 0x79, 0x7a, 0x8c, 0xfd, 0xaa, 0x21, 0xa8, 0x70,
			 0x6b, 0x67, 0x9a, 0x28, 0xf5, 0xda, 0x60, 0xa3, 0x5b, 0xcb, 0x75,
			 0x10, 0xc6, 0x00, 0xae, 0x06, 0x5a, 0xf5, 0x0d, 0x62, 0x2e, 0x6b,
			 0x29, 0xac, 0x28, 0x9a, 0x1e, 0x65, 0x55, 0xab, 0x52, 0x52, 0x9d,
			 0xe1, 0xa7, 0xbd, 0xc2, 0x39, 0x7a, 0xab, 0x0e, 0xec, 0x5c, 0xe2,
			 0xc5, 0xf2, 0x63, 0x3c, 0x05, 0x34, 0xd8, 0xa9, 0xec, 0xaf, 0xf1,
			 0x8c, 0x14, 0xf7, 0xea, 0x89, 0x86, 0x8f, 0x50, 0x9f, 0xdc, 0x7b,
			 0x21, 0x0c, 0x7f, 0x2a, 0xa4, 0x8f, 0x78, 0xcb, 0x07, 0x15, 0xb7,
			 0x0f, 0xff, 0xd6, 0x61, 0x0c, 0x5e, 0xa8, 0x19, 0x46, 0x7b, 0xb9,
			 0xa2, 0xea, 0x3d, 0xdb, 0xc7, 0x9f, 0x28, 0x86, 0x7e, 0x69, 0x6c,
			 0xb3, 0x21, 0xa6, 0x59, 0x4a, 0x8a, 0x73, 0x4f, 0xab, 0xd6, 0x87,
			 0x10, 0x0b, 0x7c, 0xa1, 0x2a, 0x70, 0xdd, 0xa6, 0xfc, 0x75, 0x09,
			 0x97, 0x87, 0xc5 };
#else
char g_base[2048/8] = {
	0x93, 0x8c, 0x57, 0x1c, 0xd9, 0x2c, 0xdd, 0x35, 0xd4, 0x3c, 0xec, 0x3e, 0x9e, 0x97, 0xd6, 0x44,
	0x45, 0x83, 0x0d, 0xaf, 0x02, 0xbc, 0xc7, 0xd4, 0x03, 0x9b, 0x0c, 0x2c, 0x87, 0x0b, 0xea, 0xe3,
	0xfd, 0x5b, 0x6d, 0x4c, 0x9d, 0xed, 0xde, 0x5d, 0x52, 0x9f, 0xb7, 0x0c, 0xdf, 0x53, 0xf7, 0xcf,
	0x80, 0x8c, 0x88, 0xe7, 0xc1, 0x8c, 0x86, 0x18, 0xd2, 0xb0, 0x05, 0x62, 0xbe, 0xcf, 0xfa, 0x72,
	0x92, 0xcf, 0x8a, 0x9d, 0x40, 0x5d, 0xf5, 0xcc, 0x37, 0xf0, 0x86, 0xb6, 0x91, 0x30, 0xb5, 0x3d,
	0x25, 0x1a, 0xb6, 0x76, 0xe2, 0x6d, 0x7a, 0xf3, 0xb1, 0x71, 0xfe, 0xa6, 0x2e, 0x8c, 0xf5, 0xe8,
	0x87, 0x0e, 0x1d, 0x6f, 0x00, 0xde, 0xcd, 0x79, 0x5a, 0x14, 0x30, 0x8b, 0xf4, 0x4f, 0x1c, 0x86,
	0xb3, 0x6a, 0x4e, 0xe6, 0x7e, 0x61, 0xe5, 0xff, 0x87, 0x55, 0x0d, 0x82, 0xec, 0x0f, 0x00, 0x01,
	0x39, 0xc5, 0xd9, 0x2f, 0x3c, 0x9f, 0xbb, 0xdb, 0x20, 0xc6, 0x9d, 0xc2, 0x0c, 0x7a, 0x96, 0xfd,
};
char g_exp[2048/8] = {
	0x93, 0x32, 0xa1, 0xc0, 0x9f, 0xda, 0x89, 0x28, 0x69, 0x30, 0x34, 0x8a, 0x5e, 0x1e,
	0xed, 0x56, 0xf9, 0x1e, 0xbd, 0x50, 0xfd, 0x7a, 0x35, 0xa0, 0x70, 0x04, 0x18, 0xbc, 0x79,
	0x71, 0xc1, 0xdb, 0x31, 0xca, 0x3b, 0x69, 0xe3, 0x31, 0xa0, 0x77, 0x75, 0xa8, 0xcc, 0x52,
	0x2d, 0x76, 0x0f, 0xda, 0x27, 0xcd, 0x70, 0xeb, 0x60, 0x66, 0xae, 0x38, 0xf4, 0xac, 0xc7,
	0x2c, 0x2d, 0x3d, 0xab, 0x08, 0x3a, 0xdc, 0x4c, 0xe7, 0x48, 0xc4, 0x81, 0xe9, 0xd4, 0xc6,
	0xe2, 0x61, 0xce, 0x30, 0x4b, 0x88, 0x7c, 0xb2, 0xaa, 0x55, 0x6f, 0xef, 0xa0, 0x7d, 0x1e,
	0x1e, 0x8a, 0x99, 0x84, 0x97, 0x8f, 0x27, 0xea, 0xb6, 0xba, 0x39, 0xd2, 0x59, 0x90, 0x65,
	0xef, 0xb1, 0xcd, 0xa0, 0xae, 0x34, 0xf1, 0x64, 0xd2, 0x7b, 0xa9, 0xe8, 0x12, 0xc5, 0x47,
	0x2f, 0xf6, 0x15, 0xff, 0xe9, 0x53, 0xbd, 0xa7, 0xe4, 0x5c, 0x65, 0x37, 0xea, 0xa8, 0xab,
	0xb2, 0x38, 0x0b, 0x73, 0xbc, 0xb8, 0x13, 0xea, 0xb8, 0x50, 0x72, 0x9a, 0x68, 0x3a, 0x09,
	0x3c, 0x79, 0x0e, 0x62, 0xef, 0xae, 0x95, 0xe7, 0x4e, 0xb3, 0x96, 0x9a, 0xe0, 0x90, 0xc0,
	0xb5, 0xb5, 0xae, 0x24, 0x38, 0xf0, 0x8a, 0x6a, 0xbc, 0x50, 0xe0, 0x16, 0xcf, 0xfd, 0x9e,
	0x63, 0xc7, 0xd2, 0x88, 0xd2, 0x49, 0xdf, 0x61, 0xdb, 0xea, 0xca, 0xac, 0x3a, 0x07, 0xbc,
	0x20, 0xda, 0x69, 0xe8, 0x5a, 0x8b, 0xca, 0xf8, 0x5d, 0xf3, 0xab, 0xcd, 0x7b, 0x8c, 0xd9,
	0x8c, 0x16, 0xa5, 0x0d, 0xfc, 0x0a, 0x81, 0x5e, 0x66, 0x50, 0x05, 0x27, 0xa4, 0x68, 0x9a,
	0x19, 0xee, 0xa1, 0x2e, 0xc0, 0x61, 0x08, 0xec, 0x76, 0x60, 0x67, 0x15, 0x84, 0x03, 0x48,
	0xfa, 0xcb, 0xc8, 0xf4, 0xef, 0x71, 0xff, 0x46, 0x49, 0x98, 0x87, 0x87, 0xa2, 0x0e, 0xda,
	0xf4, 0xb9
};
char g_mode[]	= {
	0xbb, 0x4c, 0xdf, 0x2f, 0xce, 0xe8, 0x82, 0x8e, 0x97, 0xa1, 0x3b, 0xb1, 0x38, 0xfb,
	0x66, 0x53, 0x2f, 0xcf, 0x0b, 0x37, 0x82, 0x20, 0x36, 0xaf, 0xfd, 0x65, 0xee, 0x7a, 0x2c,
	0x51, 0x31, 0x5d, 0x9d, 0x95, 0x59, 0xf0, 0x98, 0x45, 0x3e, 0xec, 0xf2, 0xf9, 0x50, 0x91,
	0xe6, 0x58, 0x12, 0x69, 0x52, 0x24, 0xc6, 0x48, 0x6c, 0xd7, 0x87, 0x79, 0xe4, 0xb3, 0x87,
	0x9f, 0x32, 0xdf, 0x05, 0xd6, 0xf6, 0xc3, 0x3e, 0xe8, 0x7e, 0x4e, 0x79, 0xd5, 0xfe, 0x62,
	0x19, 0xf5, 0x74, 0xa6, 0x8e, 0x72, 0x03, 0x11, 0x46, 0xf9, 0x04, 0x97, 0xcc, 0x40, 0x82,
	0x3e, 0x10, 0x5a, 0x56, 0x7a, 0xef, 0xb8, 0x28, 0x45, 0xf7, 0xc8, 0x1d, 0xa3, 0xee, 0xa4,
	0x12, 0xb5, 0x0e, 0xdb, 0xe1, 0x1c, 0xb3, 0xb7, 0xde, 0x7b, 0x6a, 0xb0, 0x29, 0xfa, 0x09,
	0x0a, 0xd6, 0x39, 0x42, 0x46, 0xdd, 0xb9, 0x5e, 0x72, 0xfe, 0x69, 0xf3, 0x27, 0xf0, 0x0f,
	0x6d, 0x42, 0xef, 0x81, 0xa1, 0x15, 0xc9, 0xed, 0xa3, 0x30, 0x14, 0xef, 0x76, 0x5e, 0xdd,
	0xb8, 0xa4, 0x5c, 0x71, 0x7a, 0xdf, 0x40, 0x66, 0x06, 0x3f, 0x80, 0x42, 0x2a, 0x4a, 0x90,
	0xe2, 0xa8, 0xeb, 0x9a, 0x51, 0x50, 0x10, 0x69, 0x92, 0x37, 0xca, 0x90, 0xce, 0x62, 0xe1,
	0x39, 0x27, 0x7a, 0xe2, 0x41, 0x66, 0x95, 0x16, 0xbc, 0x5e, 0x62, 0x69, 0x80, 0xc1, 0x80,
	0x56, 0x8b, 0x12, 0x7d, 0x16, 0x85, 0xea, 0x93, 0x54, 0xe5, 0x63, 0xed, 0xac, 0x31, 0xe6,
	0x57, 0x2e, 0xd1, 0x35, 0xd1, 0x4c, 0xed, 0x99, 0x38, 0x8f, 0xf5, 0x09, 0x92, 0x85, 0xe2,
	0xd8, 0x67, 0x01, 0x23, 0x26, 0xae, 0x59, 0x35, 0x2b, 0x2c, 0x09, 0xef, 0xf8, 0xe3, 0x1f,
	0xc7, 0x5f, 0x92, 0x19, 0x6e, 0x21, 0x87, 0x38, 0x40, 0x43, 0x0b, 0x02, 0x6c, 0x72, 0x6e,
	0xcc, 0xb3
};
#endif
#if 0
char g_p2[]= { 0x98, 0xe3, 0xf6, 0x3d, 0xa4, 0x56, 0xc2, 0xe3, 0xed, 0xf0,
			   0x66, 0xdc, 0xc7, 0xf3, 0x60, 0x77, 0x1a, 0x57, 0x70, 0x85,
			   0xc9, 0xcb, 0x79, 0x8b, 0x71, 0xcd, 0xcb, 0xc1, 0xba, 0xf2,
			   0xb8, 0x1a, 0x2e, 0x8c, 0x3b, 0xf6, 0x6d, 0x6b, 0x92, 0x0d,
			   0x8a, 0xed, 0x64, 0x2d, 0x8a, 0xe3, 0x23, 0x63, 0x68, 0xc0,
			   0x58, 0xa6, 0xcd, 0xe2, 0x5c, 0xeb, 0xb3, 0xbd, 0xea, 0xd8,
			   0x8a, 0x8f, 0x53, 0x66, 0xa8, 0x9b, 0x92, 0x7a, 0xc0, 0xd3,
			   0x89, 0x28, 0xdd, 0x25, 0x81, 0xba, 0xb4, 0xd1, 0xbe, 0xd2,
			   0xd0, 0xf0, 0x6e, 0x30, 0x25, 0x33, 0x3c, 0x13, 0x79, 0xc9,
			   0xbb, 0x88, 0x81, 0x4b, 0x31, 0x17, 0x39, 0xb1, 0x43, 0xcb,
			   0x28, 0x88, 0x08, 0xd8, 0x88, 0xcd, 0x71, 0x84, 0x1c, 0x1d,
			   0x78, 0xf3, 0xe2, 0x43, 0x87, 0xff, 0x2e, 0x46, 0x01, 0x8e,
			   0xc6, 0x24, 0xbc, 0x46, 0x0e, 0x9f, 0x50, 0x5e, 0x9b, 0xba,
			   0xd7, 0x81, 0x17, 0x7f, 0xfd, 0x0f, 0x03, 0xb0, 0xd6, 0xf8,
			   0x5a, 0x23, 0xf9, 0x7b, 0x58, 0x69, 0x8b, 0x60, 0x5c, 0x13,
			   0x97, 0xdb, 0x21, 0x1c, 0xe8, 0x1e, 0x8d, 0x58, 0xba, 0x16,
			   0x49, 0x15, 0x42, 0x1b, 0x6e, 0x1c, 0x38, 0x99, 0x72, 0xbc,
			   0x93, 0xdb, 0x9b, 0x63, 0x69, 0x91, 0xbc, 0xd7, 0x61, 0x0a,
			   0x18, 0x2f, 0xdc, 0xcf, 0xb4, 0x01, 0x71, 0xc4, 0xb2, 0x90,
			   0x41, 0x31, 0x3e, 0xbb, 0x4d, 0xf5, 0x62, 0xb2, 0x90, 0x67,
			   0xf3, 0x76, 0x55, 0x6e, 0x36, 0xa1, 0xcc, 0xc0, 0x2a, 0x07,
			   0xc4, 0x43, 0x51, 0x74, 0xc9, 0x71, 0x6b, 0x26, 0xfa, 0x49,
			   0x66, 0x95, 0xdb, 0xdd, 0xb8, 0x9c, 0xc6, 0x52, 0x63, 0xc5,
			   0x9c, 0x17, 0x31, 0x06, 0xa2, 0xfa, 0x7a, 0x44, 0x69, 0xd7,
			   0xd7, 0x6e, 0x9a, 0xa7, 0xb6, 0xd5, 0x43, 0xec, 0x93, 0x5f,
			   0x28, 0x87, 0xff, 0xac, 0x74, 0xaa };
char g_res[] = { 0x6c, 0x1d, 0xac, 0x7d, 0x82, 0xbb, 0x92, 0x67, 0xf8, 0x06,
			 	 0xbd, 0x10, 0x6b, 0x37, 0x6a, 0x13, 0x26, 0xb5, 0x6e, 0x57,
			 	 0x5c, 0x1f, 0x3f, 0x02, 0x39, 0xc3, 0xbd, 0x0c, 0x33, 0x23,
			 	 0x83, 0xcf, 0x4b, 0x37, 0xd0, 0x1d, 0x24, 0x87, 0x4b, 0x0f,
			 	 0x21, 0x02, 0xc1, 0x1e, 0xb7, 0x34, 0xb8, 0x81, 0x9c, 0x93,
			 	 0xfb, 0x00, 0x22, 0x1a, 0x24, 0x8f, 0x3a, 0xae, 0x51, 0x60,
			 	 0x13, 0x0b, 0xee, 0x3c, 0x9b, 0x61, 0xeb, 0x7f, 0xe5, 0xeb,
			 	 0xc6, 0x1c, 0x5c, 0xd9, 0x0c, 0xe2, 0x57, 0x2b, 0x42, 0xc4,
			 	 0x22, 0x41, 0xb4, 0x79, 0x9b, 0x56, 0x18, 0xc7, 0x07, 0xcd,
			 	 0x27, 0xe7, 0xcf, 0x0e, 0x30, 0xf4, 0x91, 0xd8, 0xa8, 0x9d,
			 	 0x72, 0x9e, 0x6f, 0x0f, 0xa1, 0x73, 0xfc, 0x82, 0x27, 0x2c,
			 	 0x98, 0xb4, 0x96, 0x24, 0xa5, 0xaa, 0x4c, 0x5b, 0x01, 0xa8,
			 	 0x75, 0x16, 0xb2, 0x16, 0x91, 0x7f, 0x16, 0xb8, 0x01, 0xa2,
			 	 0x64, 0xd4, 0x7e, 0xa4, 0x9f, 0xcb, 0xea, 0x7a, 0x33, 0x82,
			 	 0x45, 0x49, 0xa4, 0x13, 0xf7, 0x4c, 0xd9, 0x1c, 0x2a, 0x58,
			 	 0xd2, 0xfa, 0x5c, 0xfd, 0x4c, 0xed, 0xe3, 0xdf, 0xd6, 0x8f,
			 	 0x68, 0x6c, 0xb8, 0x0b, 0xa0, 0x26, 0xa2, 0x43, 0x6b, 0x9f,
			 	 0x31, 0x58, 0x05, 0xde, 0x6b, 0x0a, 0x63, 0x14, 0xfb, 0xba,
			 	 0x64, 0x59, 0xf2, 0x95, 0xe1, 0xba, 0x52, 0x4b, 0x9a, 0xb0,
			 	 0x36, 0x09, 0x48, 0x84, 0xea, 0x2d, 0x25, 0x13, 0xce, 0x09,
			 	 0x70, 0x6a, 0x27, 0xab, 0xf0, 0xc1, 0x8e, 0x44, 0x0b, 0x64,
			 	 0x0a, 0x58, 0x6b, 0x82, 0x3c, 0xe8, 0xd1, 0x18, 0xbb, 0xcc,
			 	 0x2e, 0x41, 0x90, 0xf9, 0xce, 0x32, 0x8a, 0x3b, 0x8b, 0xe7,
			 	 0x0a, 0x37, 0x25, 0x79, 0x60, 0x2b, 0xc9, 0x0d, 0x55, 0x88,
			 	 0xf1, 0x2c, 0x40, 0xa5, 0x09, 0x1c, 0x3b, 0xe4, 0x0f, 0xcf,
			 	 0x7d, 0x5e, 0xe1, 0x66, 0x08, 0x63 };
#endif
rsabase_t g_w = 0x5BA26673940A6C9D;

static void swap_buf(char *buf, u32 len)
{
	int i;
	char temp;

	for (i = 0; i < len/2; ++i) {
		temp = buf[i];
		buf[i] = buf[len - 1 - i];
		buf[len - 1 - i] = temp;
	}
}

static int rsa_pow_sw(char *cbase, int baselen,
						char *cexp, int explen,
						char *cmode, int modelen,
						char **cres,  int *reslen)
{
	int ret, bytes, sign;
	char *buf;
	MPI  base,  exp, mod, res;
	u64 t0, t1;

	base = mpi_read_raw_data(cbase, baselen);
	exp = mpi_read_raw_data(cexp, explen);
	mod = mpi_read_raw_data(cmode, modelen);
	res = mpi_alloc(modelen);

	t0 = ktime_get_ns();
	mpi_powm(res, base, exp, mod);
	t1 = ktime_get_ns();
	ret = t1 - t0;

	buf = mpi_get_buffer(res, &bytes, &sign);
#if 1
	if (bytes & 7) { // big-endian padding zero
		int i = 8 - (bytes & 7);
		memmove(buf + i, buf, bytes);
		memset(buf, 0, i);
		bytes += i;
	}
#endif
	*reslen = bytes;
	*cres = buf;

	mpi_free(base);
	mpi_free(exp);
	mpi_free(mod);
	mpi_free(res);

	return ret;
}

#if 0
static int rsa_test_case(void *para)
{
	/*c = m^e % n */
	int ret =0;
	rsa_para base, exp, mode, res, p2_para;

	base.crp_p = g_base;
	base.crp_bytes = sizeof(g_base);

	exp.crp_p = g_exp;
	exp.crp_bytes = sizeof(g_exp);

	mode.crp_p = g_mode;
	mode.crp_bytes = sizeof(g_mode);

	p2_para.crp_bytes = mode.crp_bytes;
	p2_para.crp_p = kzalloc(mode.crp_bytes, GFP_KERNEL);

	res.crp_p = kzalloc(BITS2BYTES(2048), GFP_KERNEL);
	res.crp_bytes = 0;

	ret = mont_p2(&mode, &p2_para);
	if (ret) {
		printk("mont_p2 fail ret = %d\n", ret);
		goto out;
	}
	swap_buf(p2_para.crp_p, p2_para.crp_bytes);
	if(memcmp(g_p2, p2_para.crp_p, sizeof(g_p2))) {
		printk("p2 calculate fail\n");
		printk("right:");
		dump_buf(g_p2,  sizeof(g_p2));
		printk("false:");
		dump_buf(p2_para.crp_p, p2_para.crp_bytes);
		ret = 1;
		goto out;
	}

out:
	kfree(p2_para.crp_p );
	return ret;
}
#endif

static int rsa_test_case_montw(void *para)
{

	rsa_para mode;
	rsabase_t w1;
	u64 t0, t1;

	mode.crp_p = g_mode;
	mode.crp_bytes = sizeof(g_mode);

	t0 = ktime_get_ns();
	w1 = mont_w(&mode);
	t1 = ktime_get_ns();
	printk("montw,%lld ns\n", (t1 - t0));

	if (w1 != g_w) {
		printk("mont_w fail,w:0x%llx, mont_w:0x%llx\n", g_w, w1);
		return 1;
	}
	return 0;
}



static int rsa_pow_hw(char *cbase, int baselen,
						char *cexp, int explen,
						char *cmode, int modelen,
						char **cres,  int *reslen)
{

	rsa_para base, exp, mode, res;
	int ret = 0;
	u64 t0, t1;

	base.crp_p = cbase;
	base.crp_bytes = baselen;

	exp.crp_p = cexp;
	exp.crp_bytes = explen;

	mode.crp_p = cmode;
	mode.crp_bytes = modelen;

	res.crp_p = kmalloc(modelen, GFP_KERNEL);
	if (IS_ERR_OR_NULL(res.crp_p))
	{
		printk("kmalloc res buf fail\n");
		return -ENOMEM;
	}
	res.crp_bytes = modelen;
	t0 = ktime_get_ns();
	ret = sp_powm(&res, &base, &exp, &mode);
	if (ret)  {
		printk("sp_powm fail: %d\n", ret);
		goto out;
	}
	t1 = ktime_get_ns();
	ret = t1 - t0;

	*cres = res.crp_p;
	*reslen = res.crp_bytes;
out:
	return ret;
}

static int rsa_hw_test_case(void *para)
{
	char *swres;
	int swlen;
	int ret;
	rsa_para base, exp, mode, res;

	base.crp_p = kmalloc(256, GFP_KERNEL);
	exp.crp_p = kmalloc(256, GFP_KERNEL);
	mode.crp_p = kmalloc(256, GFP_KERNEL);
	res.crp_p = kmalloc(256, GFP_KERNEL);
#if 0
	swap_buf(g_exp, sizeof(g_exp));
	swap_buf(g_mode, sizeof(g_mode));
#endif
	memcpy(base.crp_p, g_base, sizeof(g_base));
	base.crp_bytes = sizeof(g_base);

	memcpy(exp.crp_p,g_exp, sizeof(g_exp));
	exp.crp_bytes = sizeof(g_exp);

	memcpy(mode.crp_p,g_mode, sizeof(g_mode));
	mode.crp_bytes = sizeof(g_mode);

	ret = sp_powm(&res, &base, &exp, &mode);
	if (ret)  {
		printk("sp_powm fail: %d\n", ret);
		goto out;
	}

	swap_buf(g_base, sizeof(g_base));
	swap_buf(g_exp, sizeof(g_exp));
	swap_buf(g_mode, sizeof(g_mode));
	rsa_pow_sw(g_base, sizeof(g_base),
				g_exp, sizeof(g_exp),
				g_mode, sizeof(g_mode),
				&swres, &swlen);
	swap_buf(g_base, sizeof(g_base));
	swap_buf(g_exp, sizeof(g_exp));
	swap_buf(g_mode, sizeof(g_mode));

	swap_buf(swres, swlen);
	ret = -((swlen != res.crp_bytes) || memcmp(swres, res.crp_p, swlen));
	if (ret) {
		printk("HW enc & SW enc result diff\n");
	}
	printk("SW result ");
	dump_buf(swres, swlen);
	printk("HW result ");
	dump_buf(res.crp_p, res.crp_bytes);

	kfree(swres);

out:
#if 0
	swap_buf(g_exp, sizeof(g_exp));
	swap_buf(g_mode, sizeof(g_mode));
#endif
	kfree(base.crp_p);
	kfree(exp.crp_p);
	kfree(mode.crp_p);
	kfree(res.crp_p);

	return ret;
}

static volatile int rsa_tt_stop = 0;

static int rsa_random_test_case(void *para)
{
	int i, j;
	char *base, *exp1, *exp2, *mode;
	int baselen, exp1len, exp2len, modelen;
	int ret = 0;
	u32 pid = current->tgid;

	base = kmalloc(256, GFP_KERNEL);
	exp1 = kmalloc(256, GFP_KERNEL);
	exp2 = kmalloc(256, GFP_KERNEL);
	mode = kmalloc(256, GFP_KERNEL);

	printk("[%d]\tkeypair\te1bits\te2bits\tnbits\tA(bits)\t     hw_enc     hw_dec     sw_enc     sw_dec\n", pid);
	i = para ? (int)para : ARRAY_SIZE(rsa_keyparit);
	j = 0;
	while (i-- && !rsa_tt_stop) {
		u32 e1_pure_len, e2_pure_len;

		exp1len = rsa_keyparit[j].len;
		memcpy(exp1, rsa_keyparit[j].e1, exp1len);

		exp2len = rsa_keyparit[j].len;
		memcpy(exp2, rsa_keyparit[j].e2, exp2len);

		modelen = rsa_keyparit[j].len;
		memcpy(mode, rsa_keyparit[j].n, modelen);

		e1_pure_len = exp1len;
		e2_pure_len = exp2len;
		while (!exp1[e1_pure_len - 1]) {
			e1_pure_len--;
		}

		while (!exp2[e2_pure_len - 1]) {
			e2_pure_len--;
		}

		if (j >= 2) {
			if (j & 1) {
				swap_buf(exp1, exp1len);
			} else {
				swap_buf(exp2, exp2len);
			}
			swap_buf(mode, modelen);
		}

		for (baselen = 8; baselen <= modelen && !rsa_tt_stop; baselen += 8)
		//for (baselen = modelen; baselen > 0; baselen -= 8)
		{
			char *swres1, *swres2, *hwres1, *hwres2;
			int swlen1, swlen2, hwlen1, hwlen2;
			int t_hwe, t_hwd, t_swe, t_swd;

			swres1 = swres2 = hwres1 = hwres2 = NULL;

			//baselen = modelen;
			get_random_bytes(base, baselen);
			if (baselen == modelen)
				base[baselen - 1] = mode[modelen - 1] - 1;
			else
				memset(base + baselen, 0, modelen - baselen);

			//printk("%d\n", baselen * 8);
			t_hwe = rsa_pow_hw(base, modelen,
								exp1, exp1len,
								mode, modelen,
								&hwres1, &hwlen1);
			if (t_hwe < 0) {
				printk("[%d] HW enc fail\n", pid);
				ret = t_hwe;
				goto next;
			}

			t_hwd = rsa_pow_hw(hwres1, hwlen1,
								exp2, exp2len,
								mode, modelen,
								&hwres2, &hwlen2);
			if (t_hwd < 0) {
				printk("HW dec fail\n");
				ret = t_hwd;
				goto next;
			}

			if (memcmp(base, hwres2, baselen)) {
				printk("HW enc+dec result error\n");
				printk("base ");
				dump_buf(base, baselen);
				printk("HW enc+dec result ");
				dump_buf(hwres2, hwlen2);
				ret = -1;
				goto next;
			}

			swap_buf(hwres1, hwlen1);
			swap_buf(base, baselen);
			swap_buf(exp1, exp1len);
			swap_buf(exp2, exp2len);
			swap_buf(mode, modelen);

			t_swe = rsa_pow_sw(base, baselen,
								exp1, exp1len,
								mode, modelen,
								&swres1, &swlen1);
			if (memcmp(swres1, hwres1, swlen1)) {
				printk("HW enc & SW enc result diff\n");
				printk("SW enc result ");
				dump_buf(swres1, swlen1);
				printk("HW enc result ");
				dump_buf(hwres1, hwlen1);
#if 0
				printk("base ");
				swap_buf(base, baselen);
				dump_buf(base, baselen);
				printk("exp1 ");
				swap_buf(exp1, exp1len);
				dump_buf(exp1, exp1len);
				printk("mode ");
				swap_buf(mode, modelen);
				dump_buf(mode, modelen);
#endif
				ret = -1;
				goto next;
			}

			t_swd = rsa_pow_sw(swres1, swlen1,
								exp2, exp2len,
								mode, modelen,
								&swres2, &swlen2);
			if (memcmp(swres2, base, swlen2)) {
				printk("SW enc+dec result error\n");
				printk("base ");
				dump_buf(base,  baselen);
				printk("SW enc+dec result ");
				dump_buf(swres2, swlen2);
				ret = -1;
			}

			swap_buf(base, baselen);
			swap_buf(exp1, exp1len);
			swap_buf(exp2, exp2len);
			swap_buf(mode, modelen);
next:
			if (swres1) kfree(swres1);
			if (swres2) kfree(swres2);
			if (hwres1) kfree(hwres1);
			if (hwres2) kfree(hwres2);
			if (ret) goto out;

			printk("[%d]\t%d\t%d\t%d\t%d\t%d\t%11d%11d%11d%11d\n", pid, j, e1_pure_len * 8, e2_pure_len * 8, modelen * 8, baselen * 8, t_hwe, t_hwd, t_swe, t_swd);
		}

		j = (j + 1) % ARRAY_SIZE(rsa_keyparit);
	} 
out:
	kfree(base);
	kfree(exp1);
	kfree(exp2);
	kfree(mode);

	return ret;
}

struct test_case test_case[] = {
	{
		.fun = rsa_test_case_montw,
		.name = "rsa_test_case_montw",
	},
	{
		.fun = rsa_hw_test_case,
		.name = "rsa_hw_test_case",
	},
	{
		.fun = rsa_random_test_case,
		.name = "rsa_random_test_case",
	},
};

static void testcase(int i)
{
	printk("TEST_CASE_#%02d: %s\n", i + 1, test_case[i].name);
	printk("%s\n\n", test_case[i].fun(NULL) ? "FAIL" : "SUCCESS");
}

static void rsa_mt_test(int t)
{
	int i;

	for (i = 0; i < t; i++) {
		kthread_run(rsa_random_test_case, (void *)-1, "rsa_tt%d", i);
	}

	rsa_random_test_case((void *)-1);

	rsa_tt_stop = 1;
}

static int test(const char *val, const struct kernel_param *kp)
{
	int i = *val - '0';

	rsa_tt_stop = 0;
	if (*val == 'x') // MT
		rsa_mt_test(*(val+1) - '0');
	else if (i <= ARRAY_SIZE(test_case)) {
		if (i)
			testcase(i - 1);
		else
			while (i < ARRAY_SIZE(test_case)) {
				testcase(i);
				i++;
			}
	}

	return 0;
}

static const struct kernel_param_ops test_ops = {
	.set = test,
};
module_param_cb(test, &test_ops, NULL, 0600);
